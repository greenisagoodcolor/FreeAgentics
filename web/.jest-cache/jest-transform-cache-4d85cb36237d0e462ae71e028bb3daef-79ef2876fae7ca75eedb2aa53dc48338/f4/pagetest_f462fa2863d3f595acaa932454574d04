8c3850ff0c6c559e8e49c90f4501b91e
"use strict";
// Mock Next.js navigation
jest.mock("next/navigation", ()=>({
        useRouter: jest.fn(),
        useSearchParams: jest.fn()
    }));
// Mock dashboard panel components with proper default exports
jest.mock("@/app/dashboard/components/panels/AgentPanel", ()=>{
    return function AgentPanel({ view }) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            "data-testid": "agent-panel",
            children: [
                "Agent Panel - ",
                view
            ]
        });
    };
});
jest.mock("@/app/dashboard/components/panels/ConversationPanel", ()=>{
    return function ConversationPanel({ view }) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            "data-testid": "conversation-panel",
            children: [
                "Conversation Panel - ",
                view
            ]
        });
    };
});
jest.mock("@/app/dashboard/components/panels/GoalPanel", ()=>{
    return function GoalPanel({ view }) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            "data-testid": "goal-panel",
            children: [
                "Goal Panel - ",
                view
            ]
        });
    };
});
jest.mock("@/app/dashboard/components/panels/KnowledgePanel", ()=>{
    return function KnowledgePanel({ view }) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            "data-testid": "knowledge-panel",
            children: [
                "Knowledge Panel - ",
                view
            ]
        });
    };
});
jest.mock("@/app/dashboard/components/panels/MetricsPanel", ()=>{
    return function MetricsPanel({ view }) {
        return /*#__PURE__*/ (0, _jsxruntime.jsxs)("div", {
            "data-testid": "metrics-panel",
            children: [
                "Metrics Panel - ",
                view
            ]
        });
    };
});
// Removed redundant mocks - using the corrected versions above
// Mock layout components
jest.mock("@/app/dashboard/layouts/BloombergLayout", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "bloomberg-layout",
                children: "Bloomberg Layout"
            })
    }));
jest.mock("@/app/dashboard/layouts/BloombergTerminalLayout", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "bloomberg-terminal-layout",
                children: "Bloomberg Terminal Layout"
            })
    }));
jest.mock("@/app/dashboard/layouts/ResizableLayout", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "resizable-layout",
                children: "Resizable Layout"
            })
    }));
jest.mock("@/app/dashboard/layouts/KnowledgeLayout", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "knowledge-layout",
                children: "Knowledge Layout"
            })
    }));
jest.mock("@/app/dashboard/layouts/CEODemoLayout", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "ceo-demo-layout",
                children: "CEO Demo Layout"
            })
    }));
jest.mock("@/components/dashboard/TilingWindowManager", ()=>({
        default: ()=>/*#__PURE__*/ (0, _jsxruntime.jsx)("div", {
                "data-testid": "tiling-window-manager",
                children: "Tiling Window Manager"
            })
    }));
// Mock dashboard store
jest.mock("@/lib/stores/dashboard-store", ()=>({
        useDashboardStore: ()=>({
                activeLayout: "default",
                setActiveLayout: jest.fn(),
                theme: "dark",
                setTheme: jest.fn(),
                panels: {
                    knowledge: {
                        visible: true,
                        order: 0
                    },
                    agents: {
                        visible: true,
                        order: 1
                    },
                    metrics: {
                        visible: true,
                        order: 2
                    },
                    controls: {
                        visible: true,
                        order: 3
                    },
                    conversations: {
                        visible: true,
                        order: 4
                    }
                },
                setPanelVisibility: jest.fn(),
                setPanelOrder: jest.fn()
            })
    }));
Object.defineProperty(exports, "__esModule", {
    value: true
});
const _jsxruntime = require("react/jsx-runtime");
const _react = /*#__PURE__*/ _interop_require_default(require("react"));
const _react1 = require("@testing-library/react");
const _navigation = require("next/navigation");
const _page = /*#__PURE__*/ _interop_require_default(require("../../../app/page"));
function _interop_require_default(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
describe("Dashboard Page", ()=>{
    const mockRouter = {
        push: jest.fn(),
        replace: jest.fn(),
        refresh: jest.fn()
    };
    const mockSearchParams = {
        get: jest.fn((key)=>{
            if (key === "view") return "ceo-demo";
            return null;
        }),
        has: jest.fn()
    };
    beforeEach(()=>{
        jest.clearAllMocks();
        _navigation.useRouter.mockReturnValue(mockRouter);
        _navigation.useSearchParams.mockReturnValue(mockSearchParams);
    });
    describe("Rendering", ()=>{
        it("renders without crashing", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Check for the application title instead of main role
            expect(_react1.screen.getByText("FreeAgentics")).toBeInTheDocument();
        });
        it("renders all dashboard panels", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Check that our mocked panels are rendered by checking for the mock content
            expect(_react1.screen.getByText(/Agent Panel - executive/)).toBeInTheDocument();
            expect(_react1.screen.getByText(/Conversation Panel - executive/)).toBeInTheDocument();
            expect(_react1.screen.getByText(/Goal Panel - executive/)).toBeInTheDocument();
            expect(_react1.screen.getByText(/Knowledge Panel - executive/)).toBeInTheDocument();
            expect(_react1.screen.getByText(/Metrics Panel - executive/)).toBeInTheDocument();
        });
        it("renders layout selector", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // May render a select or button for layout selection
            const layoutControl = _react1.screen.queryByRole("combobox", {
                name: /layout/i
            }) || _react1.screen.queryByRole("button", {
                name: /layout/i
            }) || _react1.screen.queryByTestId("layout-selector");
            expect(layoutControl).toBeTruthy();
        });
        it("renders in dark theme by default", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Check for dark theme class on any element
            const darkElements = document.querySelectorAll('.dark, [data-theme="dark"]');
            expect(darkElements.length).toBeGreaterThan(0);
        });
    });
    describe("Layout Management", ()=>{
        it("switches between layouts", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const layoutSelector = _react1.screen.getByRole("combobox", {
                name: /layout/i
            });
            _react1.fireEvent.change(layoutSelector, {
                target: {
                    value: "bloomberg"
                }
            });
            expect(_react1.screen.getByRole("main")).toHaveClass("layout-bloomberg");
        });
        it("loads layout from URL params", ()=>{
            mockSearchParams.get.mockReturnValue("resizable");
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByRole("main")).toHaveClass("layout-resizable");
        });
        it("updates URL when layout changes", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const layoutSelector = _react1.screen.getByRole("combobox", {
                name: /layout/i
            });
            _react1.fireEvent.change(layoutSelector, {
                target: {
                    value: "knowledge"
                }
            });
            expect(mockRouter.replace).toHaveBeenCalledWith(expect.stringContaining("layout=knowledge"));
        });
    });
    describe("Panel Visibility", ()=>{
        it("toggles panel visibility", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const visibilityToggle = _react1.screen.getByLabelText(/toggle agent panel/i);
            _react1.fireEvent.click(visibilityToggle);
            expect(_react1.screen.queryByTestId("agent-panel")).not.toBeInTheDocument();
        });
        it("shows panel configuration menu", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const configButton = _react1.screen.getByLabelText(/panel configuration/i);
            _react1.fireEvent.click(configButton);
            expect(_react1.screen.getByRole("menu")).toBeInTheDocument();
        });
        it("reorders panels via drag and drop", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const panels = _react1.screen.getAllByRole("region");
            const firstPanel = panels[0];
            const secondPanel = panels[1];
            // Simulate drag and drop
            _react1.fireEvent.dragStart(firstPanel);
            _react1.fireEvent.dragEnter(secondPanel);
            _react1.fireEvent.dragOver(secondPanel);
            _react1.fireEvent.drop(secondPanel);
            _react1.fireEvent.dragEnd(firstPanel);
            await (0, _react1.waitFor)(()=>{
                expect(panels[0]).not.toBe(firstPanel);
            });
        });
    });
    describe("Theme Management", ()=>{
        it("toggles between light and dark themes", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const themeToggle = _react1.screen.getByLabelText(/toggle theme/i);
            _react1.fireEvent.click(themeToggle);
            expect(_react1.screen.getByRole("main")).toHaveClass("light");
        });
        it("persists theme preference", ()=>{
            const { rerender } = (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const themeToggle = _react1.screen.getByLabelText(/toggle theme/i);
            _react1.fireEvent.click(themeToggle);
            // Rerender to simulate page refresh
            rerender(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByRole("main")).toHaveClass("light");
        });
    });
    describe("Real-time Updates", ()=>{
        it("displays connection status", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByText(/connected/i)).toBeInTheDocument();
        });
        it("shows loading state for data", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.queryByText(/loading/i)).not.toBeInTheDocument();
        });
        it("handles WebSocket disconnection", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Simulate WebSocket disconnection
            window.dispatchEvent(new Event("offline"));
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText(/disconnected/i)).toBeInTheDocument();
            });
        });
    });
    describe("Responsive Design", ()=>{
        it("adapts to mobile viewport", ()=>{
            // Mock mobile viewport
            Object.defineProperty(window, "innerWidth", {
                writable: true,
                configurable: true,
                value: 375
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByRole("main")).toHaveClass("mobile-layout");
        });
        it("shows mobile menu on small screens", ()=>{
            Object.defineProperty(window, "innerWidth", {
                writable: true,
                configurable: true,
                value: 375
            });
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByLabelText(/menu/i)).toBeInTheDocument();
        });
        it("handles orientation change", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Simulate orientation change
            window.dispatchEvent(new Event("orientationchange"));
            expect(_react1.screen.getByRole("main")).toHaveAttribute("data-orientation");
        });
    });
    describe("Performance", ()=>{
        it("renders efficiently with large datasets", async ()=>{
            const startTime = performance.now();
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const renderTime = performance.now() - startTime;
            expect(renderTime).toBeLessThan(100); // Should render in less than 100ms
        });
        it("implements virtual scrolling for long lists", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const scrollContainer = _react1.screen.getByTestId("virtual-scroll-container");
            expect(scrollContainer).toHaveAttribute("data-virtual-scroll", "true");
        });
        it("debounces rapid state updates", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const updateButton = _react1.screen.getByLabelText(/refresh data/i);
            // Rapid clicks
            for(let i = 0; i < 10; i++){
                _react1.fireEvent.click(updateButton);
            }
            await (0, _react1.waitFor)(()=>{
                // Should only trigger one update
                expect(mockRouter.refresh).toHaveBeenCalledTimes(1);
            });
        });
    });
    describe("Accessibility", ()=>{
        it("has proper ARIA labels", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            expect(_react1.screen.getByRole("main")).toHaveAttribute("aria-label", "Dashboard");
            expect(_react1.screen.getByRole("region", {
                name: /knowledge graph/i
            })).toBeInTheDocument();
            expect(_react1.screen.getByRole("region", {
                name: /agent panel/i
            })).toBeInTheDocument();
        });
        it("supports keyboard navigation", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const panels = _react1.screen.getAllByRole("region");
            panels[0].focus();
            _react1.fireEvent.keyDown(panels[0], {
                key: "Tab"
            });
            expect(panels[1]).toHaveFocus();
        });
        it("announces updates to screen readers", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const updateButton = _react1.screen.getByLabelText(/refresh data/i);
            _react1.fireEvent.click(updateButton);
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByRole("status")).toHaveTextContent(/data updated/i);
            });
        });
    });
    describe("Error Handling", ()=>{
        it("displays error boundary on component crash", ()=>{
            // Mock console.error to avoid noise in tests
            const consoleSpy = jest.spyOn(console, "error").mockImplementation();
            // Force an error
            const ThrowError = ()=>{
                throw new Error("Test error");
                return null; // Never reached but TypeScript needs this
            };
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                children: /*#__PURE__*/ (0, _jsxruntime.jsx)(ThrowError, {})
            }));
            expect(_react1.screen.getByText(/something went wrong/i)).toBeInTheDocument();
            consoleSpy.mockRestore();
        });
        it("shows error message on data fetch failure", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Simulate fetch error
            window.dispatchEvent(new ErrorEvent("error", {
                message: "Failed to fetch data"
            }));
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByText(/failed to fetch data/i)).toBeInTheDocument();
            });
        });
        it("provides retry mechanism on error", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            // Simulate error
            window.dispatchEvent(new ErrorEvent("error"));
            await (0, _react1.waitFor)(()=>{
                const retryButton = _react1.screen.getByText(/retry/i);
                expect(retryButton).toBeInTheDocument();
                _react1.fireEvent.click(retryButton);
                expect(mockRouter.refresh).toHaveBeenCalled();
            });
        });
    });
    describe("Export Functionality", ()=>{
        it("exports dashboard configuration", ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const exportButton = _react1.screen.getByLabelText(/export configuration/i);
            _react1.fireEvent.click(exportButton);
            expect(_react1.screen.getByText(/configuration exported/i)).toBeInTheDocument();
        });
        it("imports dashboard configuration", async ()=>{
            (0, _react1.render)(/*#__PURE__*/ (0, _jsxruntime.jsx)(_page.default, {
                ...{}
            }));
            const file = new File([
                '{"layout": "bloomberg"}'
            ], "config.json", {
                type: "application/json"
            });
            const input = _react1.screen.getByLabelText(/import configuration/i);
            _react1.fireEvent.change(input, {
                target: {
                    files: [
                        file
                    ]
                }
            });
            await (0, _react1.waitFor)(()=>{
                expect(_react1.screen.getByRole("main")).toHaveClass("layout-bloomberg");
            });
        });
    });
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXR0aGV3bW9yb25leS9idWlsZHMvRnJlZUFnZW50aWNzL3dlYi9fX3Rlc3RzX18vYXBwL2Rhc2hib2FyZC9wYWdlLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7XG4gIHJlbmRlcixcbiAgc2NyZWVuLFxuICBmaXJlRXZlbnQsXG4gIHdhaXRGb3IsXG4gIHdpdGhpbixcbn0gZnJvbSBcIkB0ZXN0aW5nLWxpYnJhcnkvcmVhY3RcIjtcbmltcG9ydCB7IHVzZVJvdXRlciwgdXNlU2VhcmNoUGFyYW1zIH0gZnJvbSBcIm5leHQvbmF2aWdhdGlvblwiO1xuaW1wb3J0IERhc2hib2FyZCBmcm9tIFwiQC9hcHAvcGFnZVwiO1xuXG4vLyBNb2NrIE5leHQuanMgbmF2aWdhdGlvblxuamVzdC5tb2NrKFwibmV4dC9uYXZpZ2F0aW9uXCIsICgpID0+ICh7XG4gIHVzZVJvdXRlcjogamVzdC5mbigpLFxuICB1c2VTZWFyY2hQYXJhbXM6IGplc3QuZm4oKSxcbn0pKTtcblxuLy8gTW9jayBkYXNoYm9hcmQgcGFuZWwgY29tcG9uZW50cyB3aXRoIHByb3BlciBkZWZhdWx0IGV4cG9ydHNcbmplc3QubW9jayhcIkAvYXBwL2Rhc2hib2FyZC9jb21wb25lbnRzL3BhbmVscy9BZ2VudFBhbmVsXCIsICgpID0+IHtcbiAgcmV0dXJuIGZ1bmN0aW9uIEFnZW50UGFuZWwoeyB2aWV3IH06IHsgdmlldzogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gPGRpdiBkYXRhLXRlc3RpZD1cImFnZW50LXBhbmVsXCI+QWdlbnQgUGFuZWwgLSB7dmlld308L2Rpdj47XG4gIH07XG59KTtcblxuamVzdC5tb2NrKFwiQC9hcHAvZGFzaGJvYXJkL2NvbXBvbmVudHMvcGFuZWxzL0NvbnZlcnNhdGlvblBhbmVsXCIsICgpID0+IHtcbiAgcmV0dXJuIGZ1bmN0aW9uIENvbnZlcnNhdGlvblBhbmVsKHsgdmlldyB9OiB7IHZpZXc6IHN0cmluZyB9KSB7XG4gICAgcmV0dXJuIDxkaXYgZGF0YS10ZXN0aWQ9XCJjb252ZXJzYXRpb24tcGFuZWxcIj5Db252ZXJzYXRpb24gUGFuZWwgLSB7dmlld308L2Rpdj47XG4gIH07XG59KTtcblxuamVzdC5tb2NrKFwiQC9hcHAvZGFzaGJvYXJkL2NvbXBvbmVudHMvcGFuZWxzL0dvYWxQYW5lbFwiLCAoKSA9PiB7XG4gIHJldHVybiBmdW5jdGlvbiBHb2FsUGFuZWwoeyB2aWV3IH06IHsgdmlldzogc3RyaW5nIH0pIHtcbiAgICByZXR1cm4gPGRpdiBkYXRhLXRlc3RpZD1cImdvYWwtcGFuZWxcIj5Hb2FsIFBhbmVsIC0ge3ZpZXd9PC9kaXY+O1xuICB9O1xufSk7XG5cbmplc3QubW9jayhcIkAvYXBwL2Rhc2hib2FyZC9jb21wb25lbnRzL3BhbmVscy9Lbm93bGVkZ2VQYW5lbFwiLCAoKSA9PiB7XG4gIHJldHVybiBmdW5jdGlvbiBLbm93bGVkZ2VQYW5lbCh7IHZpZXcgfTogeyB2aWV3OiBzdHJpbmcgfSkge1xuICAgIHJldHVybiA8ZGl2IGRhdGEtdGVzdGlkPVwia25vd2xlZGdlLXBhbmVsXCI+S25vd2xlZGdlIFBhbmVsIC0ge3ZpZXd9PC9kaXY+O1xuICB9O1xufSk7XG5cbmplc3QubW9jayhcIkAvYXBwL2Rhc2hib2FyZC9jb21wb25lbnRzL3BhbmVscy9NZXRyaWNzUGFuZWxcIiwgKCkgPT4ge1xuICByZXR1cm4gZnVuY3Rpb24gTWV0cmljc1BhbmVsKHsgdmlldyB9OiB7IHZpZXc6IHN0cmluZyB9KSB7XG4gICAgcmV0dXJuIDxkaXYgZGF0YS10ZXN0aWQ9XCJtZXRyaWNzLXBhbmVsXCI+TWV0cmljcyBQYW5lbCAtIHt2aWV3fTwvZGl2PjtcbiAgfTtcbn0pO1xuXG4vLyBSZW1vdmVkIHJlZHVuZGFudCBtb2NrcyAtIHVzaW5nIHRoZSBjb3JyZWN0ZWQgdmVyc2lvbnMgYWJvdmVcblxuLy8gTW9jayBsYXlvdXQgY29tcG9uZW50c1xuamVzdC5tb2NrKFwiQC9hcHAvZGFzaGJvYXJkL2xheW91dHMvQmxvb21iZXJnTGF5b3V0XCIsICgpID0+ICh7XG4gIGRlZmF1bHQ6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJibG9vbWJlcmctbGF5b3V0XCI+Qmxvb21iZXJnIExheW91dDwvZGl2Pixcbn0pKTtcblxuamVzdC5tb2NrKFwiQC9hcHAvZGFzaGJvYXJkL2xheW91dHMvQmxvb21iZXJnVGVybWluYWxMYXlvdXRcIiwgKCkgPT4gKHtcbiAgZGVmYXVsdDogKCkgPT4gKFxuICAgIDxkaXYgZGF0YS10ZXN0aWQ9XCJibG9vbWJlcmctdGVybWluYWwtbGF5b3V0XCI+Qmxvb21iZXJnIFRlcm1pbmFsIExheW91dDwvZGl2PlxuICApLFxufSkpO1xuXG5qZXN0Lm1vY2soXCJAL2FwcC9kYXNoYm9hcmQvbGF5b3V0cy9SZXNpemFibGVMYXlvdXRcIiwgKCkgPT4gKHtcbiAgZGVmYXVsdDogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cInJlc2l6YWJsZS1sYXlvdXRcIj5SZXNpemFibGUgTGF5b3V0PC9kaXY+LFxufSkpO1xuXG5qZXN0Lm1vY2soXCJAL2FwcC9kYXNoYm9hcmQvbGF5b3V0cy9Lbm93bGVkZ2VMYXlvdXRcIiwgKCkgPT4gKHtcbiAgZGVmYXVsdDogKCkgPT4gPGRpdiBkYXRhLXRlc3RpZD1cImtub3dsZWRnZS1sYXlvdXRcIj5Lbm93bGVkZ2UgTGF5b3V0PC9kaXY+LFxufSkpO1xuXG5qZXN0Lm1vY2soXCJAL2FwcC9kYXNoYm9hcmQvbGF5b3V0cy9DRU9EZW1vTGF5b3V0XCIsICgpID0+ICh7XG4gIGRlZmF1bHQ6ICgpID0+IDxkaXYgZGF0YS10ZXN0aWQ9XCJjZW8tZGVtby1sYXlvdXRcIj5DRU8gRGVtbyBMYXlvdXQ8L2Rpdj4sXG59KSk7XG5cbmplc3QubW9jayhcIkAvY29tcG9uZW50cy9kYXNoYm9hcmQvVGlsaW5nV2luZG93TWFuYWdlclwiLCAoKSA9PiAoe1xuICBkZWZhdWx0OiAoKSA9PiAoXG4gICAgPGRpdiBkYXRhLXRlc3RpZD1cInRpbGluZy13aW5kb3ctbWFuYWdlclwiPlRpbGluZyBXaW5kb3cgTWFuYWdlcjwvZGl2PlxuICApLFxufSkpO1xuXG4vLyBNb2NrIGRhc2hib2FyZCBzdG9yZVxuamVzdC5tb2NrKFwiQC9saWIvc3RvcmVzL2Rhc2hib2FyZC1zdG9yZVwiLCAoKSA9PiAoe1xuICB1c2VEYXNoYm9hcmRTdG9yZTogKCkgPT4gKHtcbiAgICBhY3RpdmVMYXlvdXQ6IFwiZGVmYXVsdFwiLFxuICAgIHNldEFjdGl2ZUxheW91dDogamVzdC5mbigpLFxuICAgIHRoZW1lOiBcImRhcmtcIixcbiAgICBzZXRUaGVtZTogamVzdC5mbigpLFxuICAgIHBhbmVsczoge1xuICAgICAga25vd2xlZGdlOiB7IHZpc2libGU6IHRydWUsIG9yZGVyOiAwIH0sXG4gICAgICBhZ2VudHM6IHsgdmlzaWJsZTogdHJ1ZSwgb3JkZXI6IDEgfSxcbiAgICAgIG1ldHJpY3M6IHsgdmlzaWJsZTogdHJ1ZSwgb3JkZXI6IDIgfSxcbiAgICAgIGNvbnRyb2xzOiB7IHZpc2libGU6IHRydWUsIG9yZGVyOiAzIH0sXG4gICAgICBjb252ZXJzYXRpb25zOiB7IHZpc2libGU6IHRydWUsIG9yZGVyOiA0IH0sXG4gICAgfSxcbiAgICBzZXRQYW5lbFZpc2liaWxpdHk6IGplc3QuZm4oKSxcbiAgICBzZXRQYW5lbE9yZGVyOiBqZXN0LmZuKCksXG4gIH0pLFxufSkpO1xuXG5kZXNjcmliZShcIkRhc2hib2FyZCBQYWdlXCIsICgpID0+IHtcbiAgY29uc3QgbW9ja1JvdXRlciA9IHtcbiAgICBwdXNoOiBqZXN0LmZuKCksXG4gICAgcmVwbGFjZTogamVzdC5mbigpLFxuICAgIHJlZnJlc2g6IGplc3QuZm4oKSxcbiAgfTtcblxuICBjb25zdCBtb2NrU2VhcmNoUGFyYW1zID0ge1xuICAgIGdldDogamVzdC5mbigoa2V5OiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChrZXkgPT09IFwidmlld1wiKSByZXR1cm4gXCJjZW8tZGVtb1wiO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSksXG4gICAgaGFzOiBqZXN0LmZuKCksXG4gIH07XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgKHVzZVJvdXRlciBhcyBqZXN0Lk1vY2spLm1vY2tSZXR1cm5WYWx1ZShtb2NrUm91dGVyKTtcbiAgICAodXNlU2VhcmNoUGFyYW1zIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKG1vY2tTZWFyY2hQYXJhbXMpO1xuICB9KTtcblxuICBkZXNjcmliZShcIlJlbmRlcmluZ1wiLCAoKSA9PiB7XG4gICAgaXQoXCJyZW5kZXJzIHdpdGhvdXQgY3Jhc2hpbmdcIiwgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG4gICAgICAvLyBDaGVjayBmb3IgdGhlIGFwcGxpY2F0aW9uIHRpdGxlIGluc3RlYWQgb2YgbWFpbiByb2xlXG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dChcIkZyZWVBZ2VudGljc1wiKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KFwicmVuZGVycyBhbGwgZGFzaGJvYXJkIHBhbmVsc1wiLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcblxuICAgICAgLy8gQ2hlY2sgdGhhdCBvdXIgbW9ja2VkIHBhbmVscyBhcmUgcmVuZGVyZWQgYnkgY2hlY2tpbmcgZm9yIHRoZSBtb2NrIGNvbnRlbnRcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9BZ2VudCBQYW5lbCAtIGV4ZWN1dGl2ZS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL0NvbnZlcnNhdGlvbiBQYW5lbCAtIGV4ZWN1dGl2ZS8pKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL0dvYWwgUGFuZWwgLSBleGVjdXRpdmUvKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9Lbm93bGVkZ2UgUGFuZWwgLSBleGVjdXRpdmUvKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9NZXRyaWNzIFBhbmVsIC0gZXhlY3V0aXZlLykpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdChcInJlbmRlcnMgbGF5b3V0IHNlbGVjdG9yXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuICAgICAgLy8gTWF5IHJlbmRlciBhIHNlbGVjdCBvciBidXR0b24gZm9yIGxheW91dCBzZWxlY3Rpb25cbiAgICAgIGNvbnN0IGxheW91dENvbnRyb2wgPVxuICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoXCJjb21ib2JveFwiLCB7IG5hbWU6IC9sYXlvdXQvaSB9KSB8fFxuICAgICAgICBzY3JlZW4ucXVlcnlCeVJvbGUoXCJidXR0b25cIiwgeyBuYW1lOiAvbGF5b3V0L2kgfSkgfHxcbiAgICAgICAgc2NyZWVuLnF1ZXJ5QnlUZXN0SWQoXCJsYXlvdXQtc2VsZWN0b3JcIik7XG4gICAgICBleHBlY3QobGF5b3V0Q29udHJvbCkudG9CZVRydXRoeSgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJyZW5kZXJzIGluIGRhcmsgdGhlbWUgYnkgZGVmYXVsdFwiLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcbiAgICAgIC8vIENoZWNrIGZvciBkYXJrIHRoZW1lIGNsYXNzIG9uIGFueSBlbGVtZW50XG4gICAgICBjb25zdCBkYXJrRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAgICAgICAnLmRhcmssIFtkYXRhLXRoZW1lPVwiZGFya1wiXScsXG4gICAgICApO1xuICAgICAgZXhwZWN0KGRhcmtFbGVtZW50cy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJMYXlvdXQgTWFuYWdlbWVudFwiLCAoKSA9PiB7XG4gICAgaXQoXCJzd2l0Y2hlcyBiZXR3ZWVuIGxheW91dHNcIiwgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IGxheW91dFNlbGVjdG9yID0gc2NyZWVuLmdldEJ5Um9sZShcImNvbWJvYm94XCIsIHsgbmFtZTogL2xheW91dC9pIH0pO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShsYXlvdXRTZWxlY3RvciwgeyB0YXJnZXQ6IHsgdmFsdWU6IFwiYmxvb21iZXJnXCIgfSB9KTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoXCJtYWluXCIpKS50b0hhdmVDbGFzcyhcImxheW91dC1ibG9vbWJlcmdcIik7XG4gICAgfSk7XG5cbiAgICBpdChcImxvYWRzIGxheW91dCBmcm9tIFVSTCBwYXJhbXNcIiwgKCkgPT4ge1xuICAgICAgbW9ja1NlYXJjaFBhcmFtcy5nZXQubW9ja1JldHVyblZhbHVlKFwicmVzaXphYmxlXCIpO1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKFwibWFpblwiKSkudG9IYXZlQ2xhc3MoXCJsYXlvdXQtcmVzaXphYmxlXCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJ1cGRhdGVzIFVSTCB3aGVuIGxheW91dCBjaGFuZ2VzXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCBsYXlvdXRTZWxlY3RvciA9IHNjcmVlbi5nZXRCeVJvbGUoXCJjb21ib2JveFwiLCB7IG5hbWU6IC9sYXlvdXQvaSB9KTtcbiAgICAgIGZpcmVFdmVudC5jaGFuZ2UobGF5b3V0U2VsZWN0b3IsIHsgdGFyZ2V0OiB7IHZhbHVlOiBcImtub3dsZWRnZVwiIH0gfSk7XG5cbiAgICAgIGV4cGVjdChtb2NrUm91dGVyLnJlcGxhY2UpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxuICAgICAgICBleHBlY3Quc3RyaW5nQ29udGFpbmluZyhcImxheW91dD1rbm93bGVkZ2VcIiksXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIlBhbmVsIFZpc2liaWxpdHlcIiwgKCkgPT4ge1xuICAgIGl0KFwidG9nZ2xlcyBwYW5lbCB2aXNpYmlsaXR5XCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCB2aXNpYmlsaXR5VG9nZ2xlID0gc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC90b2dnbGUgYWdlbnQgcGFuZWwvaSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2sodmlzaWJpbGl0eVRvZ2dsZSk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRlc3RJZChcImFnZW50LXBhbmVsXCIpKS5ub3QudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvd3MgcGFuZWwgY29uZmlndXJhdGlvbiBtZW51XCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCBjb25maWdCdXR0b24gPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL3BhbmVsIGNvbmZpZ3VyYXRpb24vaSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soY29uZmlnQnV0dG9uKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoXCJtZW51XCIpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJyZW9yZGVycyBwYW5lbHMgdmlhIGRyYWcgYW5kIGRyb3BcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IHBhbmVscyA9IHNjcmVlbi5nZXRBbGxCeVJvbGUoXCJyZWdpb25cIik7XG4gICAgICBjb25zdCBmaXJzdFBhbmVsID0gcGFuZWxzWzBdO1xuICAgICAgY29uc3Qgc2Vjb25kUGFuZWwgPSBwYW5lbHNbMV07XG5cbiAgICAgIC8vIFNpbXVsYXRlIGRyYWcgYW5kIGRyb3BcbiAgICAgIGZpcmVFdmVudC5kcmFnU3RhcnQoZmlyc3RQYW5lbCk7XG4gICAgICBmaXJlRXZlbnQuZHJhZ0VudGVyKHNlY29uZFBhbmVsKTtcbiAgICAgIGZpcmVFdmVudC5kcmFnT3ZlcihzZWNvbmRQYW5lbCk7XG4gICAgICBmaXJlRXZlbnQuZHJvcChzZWNvbmRQYW5lbCk7XG4gICAgICBmaXJlRXZlbnQuZHJhZ0VuZChmaXJzdFBhbmVsKTtcblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChwYW5lbHNbMF0pLm5vdC50b0JlKGZpcnN0UGFuZWwpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiVGhlbWUgTWFuYWdlbWVudFwiLCAoKSA9PiB7XG4gICAgaXQoXCJ0b2dnbGVzIGJldHdlZW4gbGlnaHQgYW5kIGRhcmsgdGhlbWVzXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCB0aGVtZVRvZ2dsZSA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvdG9nZ2xlIHRoZW1lL2kpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHRoZW1lVG9nZ2xlKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoXCJtYWluXCIpKS50b0hhdmVDbGFzcyhcImxpZ2h0XCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJwZXJzaXN0cyB0aGVtZSBwcmVmZXJlbmNlXCIsICgpID0+IHtcbiAgICAgIGNvbnN0IHsgcmVyZW5kZXIgfSA9IHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCB0aGVtZVRvZ2dsZSA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvdG9nZ2xlIHRoZW1lL2kpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHRoZW1lVG9nZ2xlKTtcblxuICAgICAgLy8gUmVyZW5kZXIgdG8gc2ltdWxhdGUgcGFnZSByZWZyZXNoXG4gICAgICByZXJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoXCJtYWluXCIpKS50b0hhdmVDbGFzcyhcImxpZ2h0XCIpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIlJlYWwtdGltZSBVcGRhdGVzXCIsICgpID0+IHtcbiAgICBpdChcImRpc3BsYXlzIGNvbm5lY3Rpb24gc3RhdHVzXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL2Nvbm5lY3RlZC9pKSkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KFwic2hvd3MgbG9hZGluZyBzdGF0ZSBmb3IgZGF0YVwiLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcbiAgICAgIGV4cGVjdChzY3JlZW4ucXVlcnlCeVRleHQoL2xvYWRpbmcvaSkpLm5vdC50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJoYW5kbGVzIFdlYlNvY2tldCBkaXNjb25uZWN0aW9uXCIsIGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICAvLyBTaW11bGF0ZSBXZWJTb2NrZXQgZGlzY29ubmVjdGlvblxuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwib2ZmbGluZVwiKSk7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvZGlzY29ubmVjdGVkL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiUmVzcG9uc2l2ZSBEZXNpZ25cIiwgKCkgPT4ge1xuICAgIGl0KFwiYWRhcHRzIHRvIG1vYmlsZSB2aWV3cG9ydFwiLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIG1vYmlsZSB2aWV3cG9ydFxuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgXCJpbm5lcldpZHRoXCIsIHtcbiAgICAgICAgd3JpdGFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgdmFsdWU6IDM3NSxcbiAgICAgIH0pO1xuXG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKFwibWFpblwiKSkudG9IYXZlQ2xhc3MoXCJtb2JpbGUtbGF5b3V0XCIpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJzaG93cyBtb2JpbGUgbWVudSBvbiBzbWFsbCBzY3JlZW5zXCIsICgpID0+IHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csIFwiaW5uZXJXaWR0aFwiLCB7XG4gICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgIHZhbHVlOiAzNzUsXG4gICAgICB9KTtcblxuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG4gICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5TGFiZWxUZXh0KC9tZW51L2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgIH0pO1xuXG4gICAgaXQoXCJoYW5kbGVzIG9yaWVudGF0aW9uIGNoYW5nZVwiLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcblxuICAgICAgLy8gU2ltdWxhdGUgb3JpZW50YXRpb24gY2hhbmdlXG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJvcmllbnRhdGlvbmNoYW5nZVwiKSk7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKFwibWFpblwiKSkudG9IYXZlQXR0cmlidXRlKFwiZGF0YS1vcmllbnRhdGlvblwiKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJQZXJmb3JtYW5jZVwiLCAoKSA9PiB7XG4gICAgaXQoXCJyZW5kZXJzIGVmZmljaWVudGx5IHdpdGggbGFyZ2UgZGF0YXNldHNcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcbiAgICAgIGNvbnN0IHJlbmRlclRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgZXhwZWN0KHJlbmRlclRpbWUpLnRvQmVMZXNzVGhhbigxMDApOyAvLyBTaG91bGQgcmVuZGVyIGluIGxlc3MgdGhhbiAxMDBtc1xuICAgIH0pO1xuXG4gICAgaXQoXCJpbXBsZW1lbnRzIHZpcnR1YWwgc2Nyb2xsaW5nIGZvciBsb25nIGxpc3RzXCIsICgpID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICBjb25zdCBzY3JvbGxDb250YWluZXIgPSBzY3JlZW4uZ2V0QnlUZXN0SWQoXCJ2aXJ0dWFsLXNjcm9sbC1jb250YWluZXJcIik7XG4gICAgICBleHBlY3Qoc2Nyb2xsQ29udGFpbmVyKS50b0hhdmVBdHRyaWJ1dGUoXCJkYXRhLXZpcnR1YWwtc2Nyb2xsXCIsIFwidHJ1ZVwiKTtcbiAgICB9KTtcblxuICAgIGl0KFwiZGVib3VuY2VzIHJhcGlkIHN0YXRlIHVwZGF0ZXNcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcmVmcmVzaCBkYXRhL2kpO1xuXG4gICAgICAvLyBSYXBpZCBjbGlja3NcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgMTA7IGkrKykge1xuICAgICAgICBmaXJlRXZlbnQuY2xpY2sodXBkYXRlQnV0dG9uKTtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIC8vIFNob3VsZCBvbmx5IHRyaWdnZXIgb25lIHVwZGF0ZVxuICAgICAgICBleHBlY3QobW9ja1JvdXRlci5yZWZyZXNoKS50b0hhdmVCZWVuQ2FsbGVkVGltZXMoMSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJBY2Nlc3NpYmlsaXR5XCIsICgpID0+IHtcbiAgICBpdChcImhhcyBwcm9wZXIgQVJJQSBsYWJlbHNcIiwgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlSb2xlKFwibWFpblwiKSkudG9IYXZlQXR0cmlidXRlKFxuICAgICAgICBcImFyaWEtbGFiZWxcIixcbiAgICAgICAgXCJEYXNoYm9hcmRcIixcbiAgICAgICk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHNjcmVlbi5nZXRCeVJvbGUoXCJyZWdpb25cIiwgeyBuYW1lOiAva25vd2xlZGdlIGdyYXBoL2kgfSksXG4gICAgICApLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICBleHBlY3QoXG4gICAgICAgIHNjcmVlbi5nZXRCeVJvbGUoXCJyZWdpb25cIiwgeyBuYW1lOiAvYWdlbnQgcGFuZWwvaSB9KSxcbiAgICAgICkudG9CZUluVGhlRG9jdW1lbnQoKTtcbiAgICB9KTtcblxuICAgIGl0KFwic3VwcG9ydHMga2V5Ym9hcmQgbmF2aWdhdGlvblwiLCAoKSA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcblxuICAgICAgY29uc3QgcGFuZWxzID0gc2NyZWVuLmdldEFsbEJ5Um9sZShcInJlZ2lvblwiKTtcbiAgICAgIHBhbmVsc1swXS5mb2N1cygpO1xuXG4gICAgICBmaXJlRXZlbnQua2V5RG93bihwYW5lbHNbMF0sIHsga2V5OiBcIlRhYlwiIH0pO1xuICAgICAgZXhwZWN0KHBhbmVsc1sxXSkudG9IYXZlRm9jdXMoKTtcbiAgICB9KTtcblxuICAgIGl0KFwiYW5ub3VuY2VzIHVwZGF0ZXMgdG8gc2NyZWVuIHJlYWRlcnNcIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IHVwZGF0ZUJ1dHRvbiA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvcmVmcmVzaCBkYXRhL2kpO1xuICAgICAgZmlyZUV2ZW50LmNsaWNrKHVwZGF0ZUJ1dHRvbik7XG5cbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5Um9sZShcInN0YXR1c1wiKSkudG9IYXZlVGV4dENvbnRlbnQoL2RhdGEgdXBkYXRlZC9pKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkVycm9yIEhhbmRsaW5nXCIsICgpID0+IHtcbiAgICBpdChcImRpc3BsYXlzIGVycm9yIGJvdW5kYXJ5IG9uIGNvbXBvbmVudCBjcmFzaFwiLCAoKSA9PiB7XG4gICAgICAvLyBNb2NrIGNvbnNvbGUuZXJyb3IgdG8gYXZvaWQgbm9pc2UgaW4gdGVzdHNcbiAgICAgIGNvbnN0IGNvbnNvbGVTcHkgPSBqZXN0LnNweU9uKGNvbnNvbGUsIFwiZXJyb3JcIikubW9ja0ltcGxlbWVudGF0aW9uKCk7XG5cbiAgICAgIC8vIEZvcmNlIGFuIGVycm9yXG4gICAgICBjb25zdCBUaHJvd0Vycm9yID0gKCkgPT4ge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUZXN0IGVycm9yXCIpO1xuICAgICAgICByZXR1cm4gbnVsbDsgLy8gTmV2ZXIgcmVhY2hlZCBidXQgVHlwZVNjcmlwdCBuZWVkcyB0aGlzXG4gICAgICB9O1xuXG4gICAgICByZW5kZXIoXG4gICAgICAgIDxEYXNoYm9hcmQ+XG4gICAgICAgICAgPFRocm93RXJyb3IgLz5cbiAgICAgICAgPC9EYXNoYm9hcmQ+LFxuICAgICAgKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL3NvbWV0aGluZyB3ZW50IHdyb25nL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICBjb25zb2xlU3B5Lm1vY2tSZXN0b3JlKCk7XG4gICAgfSk7XG5cbiAgICBpdChcInNob3dzIGVycm9yIG1lc3NhZ2Ugb24gZGF0YSBmZXRjaCBmYWlsdXJlXCIsIGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICAgIHJlbmRlcig8RGFzaGJvYXJkIHsuLi4oe30gYXMgYW55KX0gLz4pO1xuXG4gICAgICAvLyBTaW11bGF0ZSBmZXRjaCBlcnJvclxuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQoXG4gICAgICAgIG5ldyBFcnJvckV2ZW50KFwiZXJyb3JcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGZldGNoIGRhdGFcIixcbiAgICAgICAgfSksXG4gICAgICApO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL2ZhaWxlZCB0byBmZXRjaCBkYXRhL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdChcInByb3ZpZGVzIHJldHJ5IG1lY2hhbmlzbSBvbiBlcnJvclwiLCBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgICByZW5kZXIoPERhc2hib2FyZCB7Li4uKHt9IGFzIGFueSl9IC8+KTtcblxuICAgICAgLy8gU2ltdWxhdGUgZXJyb3JcbiAgICAgIHdpbmRvdy5kaXNwYXRjaEV2ZW50KG5ldyBFcnJvckV2ZW50KFwiZXJyb3JcIikpO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmV0cnlCdXR0b24gPSBzY3JlZW4uZ2V0QnlUZXh0KC9yZXRyeS9pKTtcbiAgICAgICAgZXhwZWN0KHJldHJ5QnV0dG9uKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuXG4gICAgICAgIGZpcmVFdmVudC5jbGljayhyZXRyeUJ1dHRvbik7XG4gICAgICAgIGV4cGVjdChtb2NrUm91dGVyLnJlZnJlc2gpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkV4cG9ydCBGdW5jdGlvbmFsaXR5XCIsICgpID0+IHtcbiAgICBpdChcImV4cG9ydHMgZGFzaGJvYXJkIGNvbmZpZ3VyYXRpb25cIiwgKCkgPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IGV4cG9ydEJ1dHRvbiA9IHNjcmVlbi5nZXRCeUxhYmVsVGV4dCgvZXhwb3J0IGNvbmZpZ3VyYXRpb24vaSk7XG4gICAgICBmaXJlRXZlbnQuY2xpY2soZXhwb3J0QnV0dG9uKTtcblxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL2NvbmZpZ3VyYXRpb24gZXhwb3J0ZWQvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdChcImltcG9ydHMgZGFzaGJvYXJkIGNvbmZpZ3VyYXRpb25cIiwgYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgcmVuZGVyKDxEYXNoYm9hcmQgey4uLih7fSBhcyBhbnkpfSAvPik7XG5cbiAgICAgIGNvbnN0IGZpbGUgPSBuZXcgRmlsZShbJ3tcImxheW91dFwiOiBcImJsb29tYmVyZ1wifSddLCBcImNvbmZpZy5qc29uXCIsIHtcbiAgICAgICAgdHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgaW5wdXQgPSBzY3JlZW4uZ2V0QnlMYWJlbFRleHQoL2ltcG9ydCBjb25maWd1cmF0aW9uL2kpO1xuICAgICAgZmlyZUV2ZW50LmNoYW5nZShpbnB1dCwgeyB0YXJnZXQ6IHsgZmlsZXM6IFtmaWxlXSB9IH0pO1xuXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVJvbGUoXCJtYWluXCIpKS50b0hhdmVDbGFzcyhcImxheW91dC1ibG9vbWJlcmdcIik7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJuYW1lcyI6WyJqZXN0IiwibW9jayIsInVzZVJvdXRlciIsImZuIiwidXNlU2VhcmNoUGFyYW1zIiwiQWdlbnRQYW5lbCIsInZpZXciLCJkaXYiLCJkYXRhLXRlc3RpZCIsIkNvbnZlcnNhdGlvblBhbmVsIiwiR29hbFBhbmVsIiwiS25vd2xlZGdlUGFuZWwiLCJNZXRyaWNzUGFuZWwiLCJkZWZhdWx0IiwidXNlRGFzaGJvYXJkU3RvcmUiLCJhY3RpdmVMYXlvdXQiLCJzZXRBY3RpdmVMYXlvdXQiLCJ0aGVtZSIsInNldFRoZW1lIiwicGFuZWxzIiwia25vd2xlZGdlIiwidmlzaWJsZSIsIm9yZGVyIiwiYWdlbnRzIiwibWV0cmljcyIsImNvbnRyb2xzIiwiY29udmVyc2F0aW9ucyIsInNldFBhbmVsVmlzaWJpbGl0eSIsInNldFBhbmVsT3JkZXIiLCJkZXNjcmliZSIsIm1vY2tSb3V0ZXIiLCJwdXNoIiwicmVwbGFjZSIsInJlZnJlc2giLCJtb2NrU2VhcmNoUGFyYW1zIiwiZ2V0Iiwia2V5IiwiaGFzIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJtb2NrUmV0dXJuVmFsdWUiLCJpdCIsInJlbmRlciIsIkRhc2hib2FyZCIsImV4cGVjdCIsInNjcmVlbiIsImdldEJ5VGV4dCIsInRvQmVJblRoZURvY3VtZW50IiwibGF5b3V0Q29udHJvbCIsInF1ZXJ5QnlSb2xlIiwibmFtZSIsInF1ZXJ5QnlUZXN0SWQiLCJ0b0JlVHJ1dGh5IiwiZGFya0VsZW1lbnRzIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwibGVuZ3RoIiwidG9CZUdyZWF0ZXJUaGFuIiwibGF5b3V0U2VsZWN0b3IiLCJnZXRCeVJvbGUiLCJmaXJlRXZlbnQiLCJjaGFuZ2UiLCJ0YXJnZXQiLCJ2YWx1ZSIsInRvSGF2ZUNsYXNzIiwidG9IYXZlQmVlbkNhbGxlZFdpdGgiLCJzdHJpbmdDb250YWluaW5nIiwidmlzaWJpbGl0eVRvZ2dsZSIsImdldEJ5TGFiZWxUZXh0IiwiY2xpY2siLCJub3QiLCJjb25maWdCdXR0b24iLCJnZXRBbGxCeVJvbGUiLCJmaXJzdFBhbmVsIiwic2Vjb25kUGFuZWwiLCJkcmFnU3RhcnQiLCJkcmFnRW50ZXIiLCJkcmFnT3ZlciIsImRyb3AiLCJkcmFnRW5kIiwid2FpdEZvciIsInRvQmUiLCJ0aGVtZVRvZ2dsZSIsInJlcmVuZGVyIiwicXVlcnlCeVRleHQiLCJ3aW5kb3ciLCJkaXNwYXRjaEV2ZW50IiwiRXZlbnQiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwidG9IYXZlQXR0cmlidXRlIiwic3RhcnRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJyZW5kZXJUaW1lIiwidG9CZUxlc3NUaGFuIiwic2Nyb2xsQ29udGFpbmVyIiwiZ2V0QnlUZXN0SWQiLCJ1cGRhdGVCdXR0b24iLCJpIiwidG9IYXZlQmVlbkNhbGxlZFRpbWVzIiwiZm9jdXMiLCJrZXlEb3duIiwidG9IYXZlRm9jdXMiLCJ0b0hhdmVUZXh0Q29udGVudCIsImNvbnNvbGVTcHkiLCJzcHlPbiIsImNvbnNvbGUiLCJtb2NrSW1wbGVtZW50YXRpb24iLCJUaHJvd0Vycm9yIiwiRXJyb3IiLCJtb2NrUmVzdG9yZSIsIkVycm9yRXZlbnQiLCJtZXNzYWdlIiwicmV0cnlCdXR0b24iLCJ0b0hhdmVCZWVuQ2FsbGVkIiwiZXhwb3J0QnV0dG9uIiwiZmlsZSIsIkZpbGUiLCJ0eXBlIiwiaW5wdXQiLCJmaWxlcyJdLCJtYXBwaW5ncyI6IjtBQVdBLDBCQUEwQjtBQUMxQkEsS0FBS0MsSUFBSSxDQUFDLG1CQUFtQixJQUFPLENBQUE7UUFDbENDLFdBQVdGLEtBQUtHLEVBQUU7UUFDbEJDLGlCQUFpQkosS0FBS0csRUFBRTtJQUMxQixDQUFBO0FBRUEsOERBQThEO0FBQzlESCxLQUFLQyxJQUFJLENBQUMsZ0RBQWdEO0lBQ3hELE9BQU8sU0FBU0ksV0FBVyxFQUFFQyxJQUFJLEVBQW9CO1FBQ25ELHFCQUFPLHNCQUFDQztZQUFJQyxlQUFZOztnQkFBYztnQkFBZUY7OztJQUN2RDtBQUNGO0FBRUFOLEtBQUtDLElBQUksQ0FBQyx1REFBdUQ7SUFDL0QsT0FBTyxTQUFTUSxrQkFBa0IsRUFBRUgsSUFBSSxFQUFvQjtRQUMxRCxxQkFBTyxzQkFBQ0M7WUFBSUMsZUFBWTs7Z0JBQXFCO2dCQUFzQkY7OztJQUNyRTtBQUNGO0FBRUFOLEtBQUtDLElBQUksQ0FBQywrQ0FBK0M7SUFDdkQsT0FBTyxTQUFTUyxVQUFVLEVBQUVKLElBQUksRUFBb0I7UUFDbEQscUJBQU8sc0JBQUNDO1lBQUlDLGVBQVk7O2dCQUFhO2dCQUFjRjs7O0lBQ3JEO0FBQ0Y7QUFFQU4sS0FBS0MsSUFBSSxDQUFDLG9EQUFvRDtJQUM1RCxPQUFPLFNBQVNVLGVBQWUsRUFBRUwsSUFBSSxFQUFvQjtRQUN2RCxxQkFBTyxzQkFBQ0M7WUFBSUMsZUFBWTs7Z0JBQWtCO2dCQUFtQkY7OztJQUMvRDtB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