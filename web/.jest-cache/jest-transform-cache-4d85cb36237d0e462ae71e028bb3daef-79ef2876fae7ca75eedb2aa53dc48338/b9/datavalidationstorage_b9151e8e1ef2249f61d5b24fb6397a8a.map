{"version":3,"sources":["/Users/matthewmoroney/builds/FreeAgentics/web/lib/storage/data-validation-storage.ts"],"sourcesContent":["/**\n * Data validation storage utilities\n */\n\nexport class DataValidationStorage {\n  public dbName: string;\n  private storage: Map<string, Map<any, any>>;\n\n  constructor(dbName: string) {\n    this.dbName = dbName;\n    this.storage = new Map();\n  }\n\n  isValid(data: any): boolean {\n    if (data === null || data === undefined) {\n      return false;\n    }\n\n    if (typeof data === \"string\" && data.length === 0) {\n      return false;\n    }\n\n    if (typeof data === \"object\" && Object.keys(data).length === 0) {\n      return true; // Empty objects are valid\n    }\n\n    return true;\n  }\n\n  async store(collection: string, data: any): Promise<void> {\n    if (!this.isValid(data)) {\n      throw new Error(\"Invalid data\");\n    }\n\n    if (!this.storage.has(collection)) {\n      this.storage.set(collection, new Map());\n    }\n\n    const col = this.storage.get(collection)!;\n    const id = data.id || Date.now();\n    col.set(id, { ...data, id });\n  }\n\n  async get(collection: string, id: any): Promise<any> {\n    const col = this.storage.get(collection);\n    if (!col) {\n      return null;\n    }\n\n    return col.get(id) || null;\n  }\n\n  async getAll(collection: string): Promise<any[]> {\n    const col = this.storage.get(collection);\n    if (!col) {\n      return [];\n    }\n\n    return Array.from(col.values());\n  }\n\n  async update(collection: string, id: any, data: any): Promise<void> {\n    if (!this.isValid(data)) {\n      throw new Error(\"Invalid data\");\n    }\n\n    const col = this.storage.get(collection);\n    if (!col || !col.has(id)) {\n      throw new Error(\"Item not found\");\n    }\n\n    col.set(id, { ...data, id });\n  }\n\n  async delete(collection: string, id: any): Promise<void> {\n    const col = this.storage.get(collection);\n    if (!col) {\n      return;\n    }\n\n    col.delete(id);\n  }\n\n  async clear(collection?: string): Promise<void> {\n    if (collection) {\n      this.storage.delete(collection);\n    } else {\n      this.storage.clear();\n    }\n  }\n\n  async count(collection: string): Promise<number> {\n    const col = this.storage.get(collection);\n    return col ? col.size : 0;\n  }\n}\n"],"names":["DataValidationStorage","constructor","dbName","storage","Map","isValid","data","undefined","length","Object","keys","store","collection","Error","has","set","col","get","id","Date","now","getAll","Array","from","values","update","delete","clear","count","size"],"mappings":"AAAA;;CAEC;;;;+BAEYA;;;eAAAA;;;AAAN,MAAMA;IAIXC,YAAYC,MAAc,CAAE;QAC1B,IAAI,CAACA,MAAM,GAAGA;QACd,IAAI,CAACC,OAAO,GAAG,IAAIC;IACrB;IAEAC,QAAQC,IAAS,EAAW;QAC1B,IAAIA,SAAS,QAAQA,SAASC,WAAW;YACvC,OAAO;QACT;QAEA,IAAI,OAAOD,SAAS,YAAYA,KAAKE,MAAM,KAAK,GAAG;YACjD,OAAO;QACT;QAEA,IAAI,OAAOF,SAAS,YAAYG,OAAOC,IAAI,CAACJ,MAAME,MAAM,KAAK,GAAG;YAC9D,OAAO,MAAM,0BAA0B;QACzC;QAEA,OAAO;IACT;IAEA,MAAMG,MAAMC,UAAkB,EAAEN,IAAS,EAAiB;QACxD,IAAI,CAAC,IAAI,CAACD,OAAO,CAACC,OAAO;YACvB,MAAM,IAAIO,MAAM;QAClB;QAEA,IAAI,CAAC,IAAI,CAACV,OAAO,CAACW,GAAG,CAACF,aAAa;YACjC,IAAI,CAACT,OAAO,CAACY,GAAG,CAACH,YAAY,IAAIR;QACnC;QAEA,MAAMY,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,MAAMM,KAAKZ,KAAKY,EAAE,IAAIC,KAAKC,GAAG;QAC9BJ,IAAID,GAAG,CAACG,IAAI;YAAE,GAAGZ,IAAI;YAAEY;QAAG;IAC5B;IAEA,MAAMD,IAAIL,UAAkB,EAAEM,EAAO,EAAgB;QACnD,MAAMF,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,IAAI,CAACI,KAAK;YACR,OAAO;QACT;QAEA,OAAOA,IAAIC,GAAG,CAACC,OAAO;IACxB;IAEA,MAAMG,OAAOT,UAAkB,EAAkB;QAC/C,MAAMI,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,IAAI,CAACI,KAAK;YACR,OAAO,EAAE;QACX;QAEA,OAAOM,MAAMC,IAAI,CAACP,IAAIQ,MAAM;IAC9B;IAEA,MAAMC,OAAOb,UAAkB,EAAEM,EAAO,EAAEZ,IAAS,EAAiB;QAClE,IAAI,CAAC,IAAI,CAACD,OAAO,CAACC,OAAO;YACvB,MAAM,IAAIO,MAAM;QAClB;QAEA,MAAMG,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,IAAI,CAACI,OAAO,CAACA,IAAIF,GAAG,CAACI,KAAK;YACxB,MAAM,IAAIL,MAAM;QAClB;QAEAG,IAAID,GAAG,CAACG,IAAI;YAAE,GAAGZ,IAAI;YAAEY;QAAG;IAC5B;IAEA,MAAMQ,OAAOd,UAAkB,EAAEM,EAAO,EAAiB;QACvD,MAAMF,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,IAAI,CAACI,KAAK;YACR;QACF;QAEAA,IAAIU,MAAM,CAACR;IACb;IAEA,MAAMS,MAAMf,UAAmB,EAAiB;QAC9C,IAAIA,YAAY;YACd,IAAI,CAACT,OAAO,CAACuB,MAAM,CAACd;QACtB,OAAO;YACL,IAAI,CAACT,OAAO,CAACwB,KAAK;QACpB;IACF;IAEA,MAAMC,MAAMhB,UAAkB,EAAmB;QAC/C,MAAMI,MAAM,IAAI,CAACb,OAAO,CAACc,GAAG,CAACL;QAC7B,OAAOI,MAAMA,IAAIa,IAAI,GAAG;IAC1B;AACF"}