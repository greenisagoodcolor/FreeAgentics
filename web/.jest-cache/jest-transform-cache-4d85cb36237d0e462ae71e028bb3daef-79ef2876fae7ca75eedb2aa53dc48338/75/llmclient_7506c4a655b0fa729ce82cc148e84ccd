8960e2d23b887590ebd98efb5c639e61
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
function _export(target, all) {
    for(var name in all)Object.defineProperty(target, name, {
        enumerable: true,
        get: all[name]
    });
}
_export(exports, {
    LLMClient: function() {
        return LLMClient;
    },
    llmClient: function() {
        return llmClient;
    }
});
function _getRequireWildcardCache(nodeInterop) {
    if (typeof WeakMap !== "function") return null;
    var cacheBabelInterop = new WeakMap();
    var cacheNodeInterop = new WeakMap();
    return (_getRequireWildcardCache = function(nodeInterop) {
        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;
    })(nodeInterop);
}
function _interop_require_wildcard(obj, nodeInterop) {
    if (!nodeInterop && obj && obj.__esModule) {
        return obj;
    }
    if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
        return {
            default: obj
        };
    }
    var cache = _getRequireWildcardCache(nodeInterop);
    if (cache && cache.has(obj)) {
        return cache.get(obj);
    }
    var newObj = {
        __proto__: null
    };
    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;
    for(var key in obj){
        if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) {
            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;
            if (desc && (desc.get || desc.set)) {
                Object.defineProperty(newObj, key, desc);
            } else {
                newObj[key] = obj[key];
            }
        }
    }
    newObj.default = obj;
    if (cache) {
        cache.set(obj, newObj);
    }
    return newObj;
}
class LLMClient {
    constructor(config){
        const validProviders = [
            "openai",
            "anthropic",
            "google",
            "azure"
        ];
        if (!validProviders.includes(config.provider)) {
            throw new Error("Invalid provider");
        }
        this.provider = config.provider;
        this.apiKey = config.apiKey;
        this.providers = config.providers;
        if (config.useSecureStorage) {
            const { encrypt } = require("@/lib/encryption");
            encrypt(config.apiKey);
        }
    }
    async chat(messages) {
        const response = await fetch(`/api/llm/${this.provider}/chat/completions`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${this.apiKey}`
            },
            body: JSON.stringify({
                messages
            })
        });
        if (!response.ok) {
            if (response.status === 429) {
                const { RateLimitError } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("./llm-errors")));
                throw new RateLimitError("Rate limit exceeded");
            }
            if (response.status === 401) {
                const { AuthenticationError } = await Promise.resolve().then(()=>/*#__PURE__*/ _interop_require_wildcard(require("./llm-errors")));
                throw new AuthenticationError("Invalid API key");
            }
            throw new Error("Request failed");
        }
        return response.json();
    }
    async chatStream(messages) {
        const response = await fetch(`/api/llm/${this.provider}/chat/completions`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${this.apiKey}`
            },
            body: JSON.stringify({
                messages,
                stream: true
            })
        });
        if (!response.body) {
            throw new Error("No response body");
        }
        return response.body;
    }
    getProvidersByPriority() {
        return this.providers || [];
    }
    async setProvider(provider) {
        this.provider = provider;
    }
    countTokens(text) {
        // Simple approximation
        return Math.ceil(text.split(/\s+/).length * 1.3);
    }
    clearCache() {
    // Clear any cached responses
    }
    addRequestInterceptor(interceptor) {
    // Add request interceptor
    }
    addResponseInterceptor(interceptor) {
    // Add response interceptor
    }
    async createEmbedding(text) {
        const response = await fetch(`/api/llm/${this.provider}/embeddings`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${this.apiKey}`
            },
            body: JSON.stringify({
                input: text
            })
        });
        const data = await response.json();
        return data.embedding;
    }
    async analyzeImage(imageUrl, prompt) {
        const response = await fetch(`/api/llm/${this.provider}/vision`, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                Authorization: `Bearer ${this.apiKey}`
            },
            body: JSON.stringify({
                image_url: imageUrl,
                prompt
            })
        });
        const data = await response.json();
        return data.description;
    }
    async getFineTuneStatus(modelId) {
        const response = await fetch(`/api/llm/${this.provider}/fine-tunes/${modelId}`, {
            headers: {
                Authorization: `Bearer ${this.apiKey}`
            }
        });
        return response.json();
    }
    // Settings management methods
    getSettings() {
        return {
            provider: this.provider,
            apiKey: this.apiKey ? "***" : "",
            providers: this.providers
        };
    }
    updateSettings(settings) {
        if (settings.provider) this.provider = settings.provider;
        if (settings.apiKey) this.apiKey = settings.apiKey;
        if (settings.providers) this.providers = settings.providers;
    }
    async saveSettings() {
        // Save settings to storage/preferences
        return Promise.resolve(true);
    }
    // Response generation methods
    async generateResponse(prompt, options) {
        const messages = [
            {
                role: "user",
                content: prompt
            }
        ];
        const response = await this.chat(messages);
        return response.choices?.[0]?.message?.content || "";
    }
    async streamResponse(prompt, userPrompt, onChunk) {
        // For compatibility, if streaming is requested, we'll still return a string
        // but call the onChunk callback if provided
        const messages = [
            {
                role: "user",
                content: prompt
            }
        ];
        if (userPrompt) {
            messages.push({
                role: "user",
                content: userPrompt
            });
        }
        const response = await this.chat(messages);
        const content = response.choices?.[0]?.message?.content || "";
        // Call onChunk if provided (for compatibility)
        if (onChunk) {
            onChunk({
                text: content,
                isComplete: true
            });
        }
        return content;
    }
    // Belief extraction method
    async extractBeliefs(content) {
        const prompt = `Extract beliefs and convictions from the following content: ${content}`;
        const response = await this.generateResponse(prompt);
        try {
            return JSON.parse(response);
        } catch  {
            return {
                beliefs: [],
                raw: response
            };
        }
    }
    // Token usage tracking
    getTokenUsage() {
        return {
            totalTokens: 0,
            promptTokens: 0,
            completionTokens: 0
        };
    }
    // Performance metrics
    getPerformanceMetrics() {
        return {
            averageResponseTime: 0,
            successRate: 1.0,
            errorRate: 0.0
        };
    }
}
const llmClient = new LLMClient({
    provider: "openai",
    apiKey: process.env.OPENAI_API_KEY || "dummy-key"
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXR0aGV3bW9yb25leS9idWlsZHMvRnJlZUFnZW50aWNzL3dlYi9saWIvbGxtLWNsaWVudC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgaW50ZXJmYWNlIExMTUNsaWVudENvbmZpZyB7XG4gIHByb3ZpZGVyOiBzdHJpbmc7XG4gIGFwaUtleTogc3RyaW5nO1xuICB1c2VTZWN1cmVTdG9yYWdlPzogYm9vbGVhbjtcbiAgcHJvdmlkZXJzPzogQXJyYXk8eyBwcm92aWRlcjogc3RyaW5nOyBwcmlvcml0eTogbnVtYmVyIH0+O1xuICBlbmFibGVDYWNoZT86IGJvb2xlYW47XG4gIGNhY2hlVGltZW91dD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIExMTUNsaWVudCB7XG4gIHByb3ZpZGVyOiBzdHJpbmc7XG4gIHByaXZhdGUgYXBpS2V5OiBzdHJpbmc7XG4gIHByb3ZpZGVycz86IEFycmF5PHsgcHJvdmlkZXI6IHN0cmluZzsgcHJpb3JpdHk6IG51bWJlciB9PjtcblxuICBjb25zdHJ1Y3Rvcihjb25maWc6IExMTUNsaWVudENvbmZpZykge1xuICAgIGNvbnN0IHZhbGlkUHJvdmlkZXJzID0gW1wib3BlbmFpXCIsIFwiYW50aHJvcGljXCIsIFwiZ29vZ2xlXCIsIFwiYXp1cmVcIl07XG4gICAgaWYgKCF2YWxpZFByb3ZpZGVycy5pbmNsdWRlcyhjb25maWcucHJvdmlkZXIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHByb3ZpZGVyXCIpO1xuICAgIH1cblxuICAgIHRoaXMucHJvdmlkZXIgPSBjb25maWcucHJvdmlkZXI7XG4gICAgdGhpcy5hcGlLZXkgPSBjb25maWcuYXBpS2V5O1xuICAgIHRoaXMucHJvdmlkZXJzID0gY29uZmlnLnByb3ZpZGVycztcblxuICAgIGlmIChjb25maWcudXNlU2VjdXJlU3RvcmFnZSkge1xuICAgICAgY29uc3QgeyBlbmNyeXB0IH0gPSByZXF1aXJlKFwiQC9saWIvZW5jcnlwdGlvblwiKTtcbiAgICAgIGVuY3J5cHQoY29uZmlnLmFwaUtleSk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgY2hhdChtZXNzYWdlczogYW55W10pOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvbGxtLyR7dGhpcy5wcm92aWRlcn0vY2hhdC9jb21wbGV0aW9uc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG1lc3NhZ2VzIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDI5KSB7XG4gICAgICAgIGNvbnN0IHsgUmF0ZUxpbWl0RXJyb3IgfSA9IGF3YWl0IGltcG9ydChcIkAvbGliL2xsbS1lcnJvcnNcIik7XG4gICAgICAgIHRocm93IG5ldyBSYXRlTGltaXRFcnJvcihcIlJhdGUgbGltaXQgZXhjZWVkZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgY29uc3QgeyBBdXRoZW50aWNhdGlvbkVycm9yIH0gPSBhd2FpdCBpbXBvcnQoXCJAL2xpYi9sbG0tZXJyb3JzXCIpO1xuICAgICAgICB0aHJvdyBuZXcgQXV0aGVudGljYXRpb25FcnJvcihcIkludmFsaWQgQVBJIGtleVwiKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlJlcXVlc3QgZmFpbGVkXCIpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gIH1cblxuICBhc3luYyBjaGF0U3RyZWFtKG1lc3NhZ2VzOiBhbnlbXSk6IFByb21pc2U8UmVhZGFibGVTdHJlYW0+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL2xsbS8ke3RoaXMucHJvdmlkZXJ9L2NoYXQvY29tcGxldGlvbnNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBtZXNzYWdlcywgc3RyZWFtOiB0cnVlIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5ib2R5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyByZXNwb25zZSBib2R5XCIpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZS5ib2R5O1xuICB9XG5cbiAgZ2V0UHJvdmlkZXJzQnlQcmlvcml0eSgpOiBBcnJheTx7IHByb3ZpZGVyOiBzdHJpbmc7IHByaW9yaXR5OiBudW1iZXIgfT4ge1xuICAgIHJldHVybiB0aGlzLnByb3ZpZGVycyB8fCBbXTtcbiAgfVxuXG4gIGFzeW5jIHNldFByb3ZpZGVyKHByb3ZpZGVyOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0aGlzLnByb3ZpZGVyID0gcHJvdmlkZXI7XG4gIH1cblxuICBjb3VudFRva2Vucyh0ZXh0OiBzdHJpbmcpOiBudW1iZXIge1xuICAgIC8vIFNpbXBsZSBhcHByb3hpbWF0aW9uXG4gICAgcmV0dXJuIE1hdGguY2VpbCh0ZXh0LnNwbGl0KC9cXHMrLykubGVuZ3RoICogMS4zKTtcbiAgfVxuXG4gIGNsZWFyQ2FjaGUoKTogdm9pZCB7XG4gICAgLy8gQ2xlYXIgYW55IGNhY2hlZCByZXNwb25zZXNcbiAgfVxuXG4gIGFkZFJlcXVlc3RJbnRlcmNlcHRvcihpbnRlcmNlcHRvcjogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICAvLyBBZGQgcmVxdWVzdCBpbnRlcmNlcHRvclxuICB9XG5cbiAgYWRkUmVzcG9uc2VJbnRlcmNlcHRvcihpbnRlcmNlcHRvcjogRnVuY3Rpb24pOiB2b2lkIHtcbiAgICAvLyBBZGQgcmVzcG9uc2UgaW50ZXJjZXB0b3JcbiAgfVxuXG4gIGFzeW5jIGNyZWF0ZUVtYmVkZGluZyh0ZXh0OiBzdHJpbmcpOiBQcm9taXNlPG51bWJlcltdPiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9sbG0vJHt0aGlzLnByb3ZpZGVyfS9lbWJlZGRpbmdzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgaW5wdXQ6IHRleHQgfSksXG4gICAgfSk7XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBkYXRhLmVtYmVkZGluZztcbiAgfVxuXG4gIGFzeW5jIGFuYWx5emVJbWFnZShpbWFnZVVybDogc3RyaW5nLCBwcm9tcHQ6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9sbG0vJHt0aGlzLnByb3ZpZGVyfS92aXNpb25gLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuYXBpS2V5fWAsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpbWFnZV91cmw6IGltYWdlVXJsLCBwcm9tcHQgfSksXG4gICAgfSk7XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBkYXRhLmRlc2NyaXB0aW9uO1xuICB9XG5cbiAgYXN5bmMgZ2V0RmluZVR1bmVTdGF0dXMobW9kZWxJZDogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgYC9hcGkvbGxtLyR7dGhpcy5wcm92aWRlcn0vZmluZS10dW5lcy8ke21vZGVsSWR9YCxcbiAgICAgIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0aGlzLmFwaUtleX1gLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgfVxuXG4gIC8vIFNldHRpbmdzIG1hbmFnZW1lbnQgbWV0aG9kc1xuICBnZXRTZXR0aW5ncygpOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICBwcm92aWRlcjogdGhpcy5wcm92aWRlcixcbiAgICAgIGFwaUtleTogdGhpcy5hcGlLZXkgPyBcIioqKlwiIDogXCJcIiwgLy8gSGlkZSBhY3R1YWwga2V5XG4gICAgICBwcm92aWRlcnM6IHRoaXMucHJvdmlkZXJzLFxuICAgIH07XG4gIH1cblxuICB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogYW55KTogdm9pZCB7XG4gICAgaWYgKHNldHRpbmdzLnByb3ZpZGVyKSB0aGlzLnByb3ZpZGVyID0gc2V0dGluZ3MucHJvdmlkZXI7XG4gICAgaWYgKHNldHRpbmdzLmFwaUtleSkgdGhpcy5hcGlLZXkgPSBzZXR0aW5ncy5hcGlLZXk7XG4gICAgaWYgKHNldHRpbmdzLnByb3ZpZGVycykgdGhpcy5wcm92aWRlcnMgPSBzZXR0aW5ncy5wcm92aWRlcnM7XG4gIH1cblxuICBhc3luYyBzYXZlU2V0dGluZ3MoKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgLy8gU2F2ZSBzZXR0aW5ncyB0byBzdG9yYWdlL3ByZWZlcmVuY2VzXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0cnVlKTtcbiAgfVxuXG4gIC8vIFJlc3BvbnNlIGdlbmVyYXRpb24gbWV0aG9kc1xuICBhc3luYyBnZW5lcmF0ZVJlc3BvbnNlKHByb21wdDogc3RyaW5nLCBvcHRpb25zPzogYW55KTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IFt7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiBwcm9tcHQgfV07XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNoYXQobWVzc2FnZXMpO1xuICAgIHJldHVybiByZXNwb25zZS5jaG9pY2VzPy5bMF0/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgXCJcIjtcbiAgfVxuXG4gIGFzeW5jIHN0cmVhbVJlc3BvbnNlKFxuICAgIHByb21wdDogc3RyaW5nLFxuICAgIHVzZXJQcm9tcHQ/OiBzdHJpbmcsXG4gICAgb25DaHVuaz86IEZ1bmN0aW9uLFxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIC8vIEZvciBjb21wYXRpYmlsaXR5LCBpZiBzdHJlYW1pbmcgaXMgcmVxdWVzdGVkLCB3ZSdsbCBzdGlsbCByZXR1cm4gYSBzdHJpbmdcbiAgICAvLyBidXQgY2FsbCB0aGUgb25DaHVuayBjYWxsYmFjayBpZiBwcm92aWRlZFxuICAgIGNvbnN0IG1lc3NhZ2VzID0gW3sgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IHByb21wdCB9XTtcbiAgICBpZiAodXNlclByb21wdCkge1xuICAgICAgbWVzc2FnZXMucHVzaCh7IHJvbGU6IFwidXNlclwiLCBjb250ZW50OiB1c2VyUHJvbXB0IH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jaGF0KG1lc3NhZ2VzKTtcbiAgICBjb25zdCBjb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50IHx8IFwiXCI7XG5cbiAgICAvLyBDYWxsIG9uQ2h1bmsgaWYgcHJvdmlkZWQgKGZvciBjb21wYXRpYmlsaXR5KVxuICAgIGlmIChvbkNodW5rKSB7XG4gICAgICBvbkNodW5rKHsgdGV4dDogY29udGVudCwgaXNDb21wbGV0ZTogdHJ1ZSB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxuXG4gIC8vIEJlbGllZiBleHRyYWN0aW9uIG1ldGhvZFxuICBhc3luYyBleHRyYWN0QmVsaWVmcyhjb250ZW50OiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IHByb21wdCA9IGBFeHRyYWN0IGJlbGllZnMgYW5kIGNvbnZpY3Rpb25zIGZyb20gdGhlIGZvbGxvd2luZyBjb250ZW50OiAke2NvbnRlbnR9YDtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVSZXNwb25zZShwcm9tcHQpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4geyBiZWxpZWZzOiBbXSwgcmF3OiByZXNwb25zZSB9O1xuICAgIH1cbiAgfVxuXG4gIC8vIFRva2VuIHVzYWdlIHRyYWNraW5nXG4gIGdldFRva2VuVXNhZ2UoKTogYW55IHtcbiAgICByZXR1cm4ge1xuICAgICAgdG90YWxUb2tlbnM6IDAsXG4gICAgICBwcm9tcHRUb2tlbnM6IDAsXG4gICAgICBjb21wbGV0aW9uVG9rZW5zOiAwLFxuICAgIH07XG4gIH1cblxuICAvLyBQZXJmb3JtYW5jZSBtZXRyaWNzXG4gIGdldFBlcmZvcm1hbmNlTWV0cmljcygpOiBhbnkge1xuICAgIHJldHVybiB7XG4gICAgICBhdmVyYWdlUmVzcG9uc2VUaW1lOiAwLFxuICAgICAgc3VjY2Vzc1JhdGU6IDEuMCxcbiAgICAgIGVycm9yUmF0ZTogMC4wLFxuICAgIH07XG4gIH1cbn1cblxuLy8gRXhwb3J0IGEgZGVmYXVsdCBpbnN0YW5jZVxuZXhwb3J0IGNvbnN0IGxsbUNsaWVudCA9IG5ldyBMTE1DbGllbnQoe1xuICBwcm92aWRlcjogXCJvcGVuYWlcIixcbiAgYXBpS2V5OiBwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSB8fCBcImR1bW15LWtleVwiLFxufSk7XG4iXSwibmFtZXMiOlsiTExNQ2xpZW50IiwibGxtQ2xpZW50IiwiY29uc3RydWN0b3IiLCJjb25maWciLCJ2YWxpZFByb3ZpZGVycyIsImluY2x1ZGVzIiwicHJvdmlkZXIiLCJFcnJvciIsImFwaUtleSIsInByb3ZpZGVycyIsInVzZVNlY3VyZVN0b3JhZ2UiLCJlbmNyeXB0IiwicmVxdWlyZSIsImNoYXQiLCJtZXNzYWdlcyIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5Iiwib2siLCJzdGF0dXMiLCJSYXRlTGltaXRFcnJvciIsIkF1dGhlbnRpY2F0aW9uRXJyb3IiLCJqc29uIiwiY2hhdFN0cmVhbSIsInN0cmVhbSIsImdldFByb3ZpZGVyc0J5UHJpb3JpdHkiLCJzZXRQcm92aWRlciIsImNvdW50VG9rZW5zIiwidGV4dCIsIk1hdGgiLCJjZWlsIiwic3BsaXQiLCJsZW5ndGgiLCJjbGVhckNhY2hlIiwiYWRkUmVxdWVzdEludGVyY2VwdG9yIiwiaW50ZXJjZXB0b3IiLCJhZGRSZXNwb25zZUludGVyY2VwdG9yIiwiY3JlYXRlRW1iZWRkaW5nIiwiaW5wdXQiLCJkYXRhIiwiZW1iZWRkaW5nIiwiYW5hbHl6ZUltYWdlIiwiaW1hZ2VVcmwiLCJwcm9tcHQiLCJpbWFnZV91cmwiLCJkZXNjcmlwdGlvbiIsImdldEZpbmVUdW5lU3RhdHVzIiwibW9kZWxJZCIsImdldFNldHRpbmdzIiwidXBkYXRlU2V0dGluZ3MiLCJzZXR0aW5ncyIsInNhdmVTZXR0aW5ncyIsIlByb21pc2UiLCJyZXNvbHZlIiwiZ2VuZXJhdGVSZXNwb25zZSIsIm9wdGlvbnMiLCJyb2xlIiwiY29udGVudCIsImNob2ljZXMiLCJtZXNzYWdlIiwic3RyZWFtUmVzcG9uc2UiLCJ1c2VyUHJvbXB0Iiwib25DaHVuayIsInB1c2giLCJpc0NvbXBsZXRlIiwiZXh0cmFjdEJlbGllZnMiLCJwYXJzZSIsImJlbGllZnMiLCJyYXciLCJnZXRUb2tlblVzYWdlIiwidG90YWxUb2tlbnMiLCJwcm9tcHRUb2tlbnMiLCJjb21wbGV0aW9uVG9rZW5zIiwiZ2V0UGVyZm9ybWFuY2VNZXRyaWNzIiwiYXZlcmFnZVJlc3BvbnNlVGltZSIsInN1Y2Nlc3NSYXRlIiwiZXJyb3JSYXRlIiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztJQVNhQSxTQUFTO2VBQVRBOztJQWtOQUMsU0FBUztlQUFUQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFsTk4sTUFBTUQ7SUFLWEUsWUFBWUMsTUFBdUIsQ0FBRTtRQUNuQyxNQUFNQyxpQkFBaUI7WUFBQztZQUFVO1lBQWE7WUFBVTtTQUFRO1FBQ2pFLElBQUksQ0FBQ0EsZUFBZUMsUUFBUSxDQUFDRixPQUFPRyxRQUFRLEdBQUc7WUFDN0MsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO1FBRUEsSUFBSSxDQUFDRCxRQUFRLEdBQUdILE9BQU9HLFFBQVE7UUFDL0IsSUFBSSxDQUFDRSxNQUFNLEdBQUdMLE9BQU9LLE1BQU07UUFDM0IsSUFBSSxDQUFDQyxTQUFTLEdBQUdOLE9BQU9NLFNBQVM7UUFFakMsSUFBSU4sT0FBT08sZ0JBQWdCLEVBQUU7WUFDM0IsTUFBTSxFQUFFQyxPQUFPLEVBQUUsR0FBR0MsUUFBUTtZQUM1QkQsUUFBUVIsT0FBT0ssTUFBTTtRQUN2QjtJQUNGO0lBRUEsTUFBTUssS0FBS0MsUUFBZSxFQUFnQjtRQUN4QyxNQUFNQyxXQUFXLE1BQU1DLE1BQU0sQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDVixRQUFRLENBQUMsaUJBQWlCLENBQUMsRUFBRTtZQUN6RVcsUUFBUTtZQUNS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