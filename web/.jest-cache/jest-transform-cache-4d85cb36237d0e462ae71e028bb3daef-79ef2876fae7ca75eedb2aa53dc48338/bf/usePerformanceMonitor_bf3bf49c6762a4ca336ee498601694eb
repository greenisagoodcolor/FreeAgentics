5607e426ec9d7743cd3ee41b74297ed4
"use client";
"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
Object.defineProperty(exports, "usePerformanceMonitor", {
    enumerable: true,
    get: function() {
        return usePerformanceMonitor;
    }
});
const _react = require("react");
const defaultThresholds = {
    slowRenderThreshold: 16,
    memoryWarningThreshold: 50,
    reRenderWarningThreshold: 5,
    cacheHitRateMinimum: 80
};
function usePerformanceMonitor(options) {
    const { componentName, enabled = true, thresholds = {}, trackMemory = true, trackCacheHits = true, onSlowRender, onMemoryWarning, onOptimizationSuggestion } = options;
    const finalThresholds = {
        ...defaultThresholds,
        ...thresholds
    };
    const [metrics, setMetrics] = (0, _react.useState)({
        renderTime: 0,
        componentMounts: 0,
        reRenders: 0,
        memoryUsage: 0,
        lastRenderTime: 0,
        averageRenderTime: 0,
        slowRenders: 0,
        cacheHitRate: 100,
        optimizationSuggestions: []
    });
    const renderStartTime = (0, _react.useRef)(0);
    const renderTimes = (0, _react.useRef)([]);
    const mountTime = (0, _react.useRef)(0);
    const reRenderCount = (0, _react.useRef)(0);
    const cacheRequests = (0, _react.useRef)(0);
    const cacheHits = (0, _react.useRef)(0);
    const lastReRenderTime = (0, _react.useRef)(0);
    const memoryCheckInterval = (0, _react.useRef)(null);
    // Track component mount
    (0, _react.useEffect)(()=>{
        if (!enabled) return;
        mountTime.current = performance.now();
        setMetrics((prev)=>({
                ...prev,
                componentMounts: prev.componentMounts + 1
            }));
        return ()=>{
            if (memoryCheckInterval.current) {
                clearInterval(memoryCheckInterval.current);
            }
        };
    }, [
        enabled
    ]);
    // Memory monitoring
    (0, _react.useEffect)(()=>{
        if (!enabled || !trackMemory) return;
        const checkMemory = ()=>{
            if ("memory" in performance) {
                const memInfo = performance.memory;
                const usageInMB = memInfo.usedJSHeapSize / (1024 * 1024);
                setMetrics((prev)=>({
                        ...prev,
                        memoryUsage: usageInMB
                    }));
                if (usageInMB > finalThresholds.memoryWarningThreshold) {
                    onMemoryWarning?.(usageInMB);
                }
            }
        };
        checkMemory();
        memoryCheckInterval.current = setInterval(checkMemory, 5000); // Check every 5 seconds
        return ()=>{
            if (memoryCheckInterval.current) {
                clearInterval(memoryCheckInterval.current);
            }
        };
    }, [
        enabled,
        trackMemory,
        finalThresholds.memoryWarningThreshold,
        onMemoryWarning
    ]);
    // Render performance tracking
    const startRender = (0, _react.useCallback)(()=>{
        if (!enabled) return;
        renderStartTime.current = performance.now();
    }, [
        enabled
    ]);
    const endRender = (0, _react.useCallback)(()=>{
        if (!enabled || renderStartTime.current === 0) return;
        const renderTime = performance.now() - renderStartTime.current;
        renderTimes.current.push(renderTime);
        // Keep only last 100 render times for average calculation
        if (renderTimes.current.length > 100) {
            renderTimes.current.shift();
        }
        const averageRenderTime = renderTimes.current.reduce((sum, time)=>sum + time, 0) / renderTimes.current.length;
        const isSlowRender = renderTime > finalThresholds.slowRenderThreshold;
        // Track re-renders
        const now = Date.now();
        if (now - lastReRenderTime.current < 1000) {
            reRenderCount.current++;
        } else {
            reRenderCount.current = 1;
        }
        lastReRenderTime.current = now;
        setMetrics((prev)=>({
                ...prev,
                renderTime,
                lastRenderTime: renderTime,
                averageRenderTime,
                reRenders: prev.reRenders + 1,
                slowRenders: prev.slowRenders + (isSlowRender ? 1 : 0)
            }));
        if (isSlowRender) {
            onSlowRender?.(renderTime);
        }
        renderStartTime.current = 0;
    }, [
        enabled,
        finalThresholds.slowRenderThreshold,
        onSlowRender
    ]);
    // Cache performance tracking
    const trackCacheRequest = (0, _react.useCallback)((isHit = false)=>{
        if (!enabled || !trackCacheHits) return;
        cacheRequests.current++;
        if (isHit) {
            cacheHits.current++;
        }
        const hitRate = cacheHits.current / cacheRequests.current * 100;
        setMetrics((prev)=>({
                ...prev,
                cacheHitRate: hitRate
            }));
    }, [
        enabled,
        trackCacheHits
    ]);
    // Generate optimization suggestions
    const generateOptimizationSuggestions = (0, _react.useCallback)(()=>{
        const suggestions = [];
        if (metrics.averageRenderTime > finalThresholds.slowRenderThreshold) {
            suggestions.push(`Consider memoizing ${componentName} - average render time is ${metrics.averageRenderTime.toFixed(2)}ms`);
        }
        if (reRenderCount.current > finalThresholds.reRenderWarningThreshold) {
            suggestions.push(`High re-render frequency detected in ${componentName} - consider optimizing dependencies`);
        }
        if (metrics.memoryUsage > finalThresholds.memoryWarningThreshold) {
            suggestions.push(`High memory usage detected (${metrics.memoryUsage.toFixed(2)}MB) - check for memory leaks`);
        }
        if (metrics.cacheHitRate < finalThresholds.cacheHitRateMinimum) {
            suggestions.push(`Low cache hit rate (${metrics.cacheHitRate.toFixed(1)}%) - optimize caching strategy`);
        }
        if (metrics.slowRenders > 5) {
            suggestions.push(`${metrics.slowRenders} slow renders detected - consider code splitting or virtualization`);
        }
        return suggestions;
    }, [
        metrics,
        finalThresholds,
        componentName,
        reRenderCount
    ]);
    // Update suggestions periodically
    (0, _react.useEffect)(()=>{
        if (!enabled) return;
        const suggestions = generateOptimizationSuggestions();
        if (suggestions.length !== metrics.optimizationSuggestions.length || suggestions.some((s, i)=>s !== metrics.optimizationSuggestions[i])) {
            setMetrics((prev)=>({
                    ...prev,
                    optimizationSuggestions: suggestions
                }));
            if (suggestions.length > 0) {
                onOptimizationSuggestion?.(suggestions);
            }
        }
    }, [
        enabled,
        generateOptimizationSuggestions,
        metrics.optimizationSuggestions,
        onOptimizationSuggestion
    ]);
    // Performance profiler hooks
    const profileRender = (0, _react.useCallback)((renderFn)=>{
        startRender();
        try {
            renderFn();
        } finally{
            endRender();
        }
    }, [
        startRender,
        endRender
    ]);
    // Get performance report
    const getPerformanceReport = (0, _react.useCallback)(()=>{
        const report = {
            componentName,
            timestamp: new Date().toISOString(),
            metrics: {
                ...metrics
            },
            thresholds: finalThresholds,
            renderTimesHistory: [
                ...renderTimes.current
            ],
            suggestions: generateOptimizationSuggestions(),
            healthScore: calculateHealthScore()
        };
        return report;
    }, [
        componentName,
        metrics,
        finalThresholds,
        generateOptimizationSuggestions
    ]);
    // Calculate overall health score (0-100)
    const calculateHealthScore = (0, _react.useCallback)(()=>{
        let score = 100;
        // Deduct points for performance issues
        if (metrics.averageRenderTime > finalThresholds.slowRenderThreshold) {
            score -= Math.min(30, (metrics.averageRenderTime - finalThresholds.slowRenderThreshold) * 2);
        }
        if (metrics.memoryUsage > finalThresholds.memoryWarningThreshold) {
            score -= Math.min(25, (metrics.memoryUsage - finalThresholds.memoryWarningThreshold) * 0.5);
        }
        if (metrics.cacheHitRate < finalThresholds.cacheHitRateMinimum) {
            score -= Math.min(20, (finalThresholds.cacheHitRateMinimum - metrics.cacheHitRate) * 0.5);
        }
        if (reRenderCount.current > finalThresholds.reRenderWarningThreshold) {
            score -= Math.min(15, (reRenderCount.current - finalThresholds.reRenderWarningThreshold) * 3);
        }
        if (metrics.slowRenders > 0) {
            score -= Math.min(10, metrics.slowRenders);
        }
        return Math.max(0, Math.round(score));
    }, [
        metrics,
        finalThresholds,
        reRenderCount
    ]);
    // Reset metrics
    const resetMetrics = (0, _react.useCallback)(()=>{
        renderTimes.current = [];
        reRenderCount.current = 0;
        cacheRequests.current = 0;
        cacheHits.current = 0;
        setMetrics({
            renderTime: 0,
            componentMounts: 0,
            reRenders: 0,
            memoryUsage: 0,
            lastRenderTime: 0,
            averageRenderTime: 0,
            slowRenders: 0,
            cacheHitRate: 100,
            optimizationSuggestions: []
        });
    }, []);
    return {
        metrics,
        startRender,
        endRender,
        trackCacheRequest,
        profileRender,
        getPerformanceReport,
        resetMetrics,
        healthScore: calculateHealthScore(),
        isEnabled: enabled
    };
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tYXR0aGV3bW9yb25leS9idWlsZHMvRnJlZUFnZW50aWNzL3dlYi9ob29rcy91c2VQZXJmb3JtYW5jZU1vbml0b3IudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IHVzZUVmZmVjdCwgdXNlUmVmLCB1c2VTdGF0ZSwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGludGVyZmFjZSBQZXJmb3JtYW5jZU1ldHJpY3Mge1xuICByZW5kZXJUaW1lOiBudW1iZXI7XG4gIGNvbXBvbmVudE1vdW50czogbnVtYmVyO1xuICByZVJlbmRlcnM6IG51bWJlcjtcbiAgbWVtb3J5VXNhZ2U6IG51bWJlcjtcbiAgbGFzdFJlbmRlclRpbWU6IG51bWJlcjtcbiAgYXZlcmFnZVJlbmRlclRpbWU6IG51bWJlcjtcbiAgc2xvd1JlbmRlcnM6IG51bWJlcjtcbiAgY2FjaGVIaXRSYXRlOiBudW1iZXI7XG4gIG9wdGltaXphdGlvblN1Z2dlc3Rpb25zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBQZXJmb3JtYW5jZVRocmVzaG9sZHMge1xuICBzbG93UmVuZGVyVGhyZXNob2xkOiBudW1iZXI7IC8vIG1zXG4gIG1lbW9yeVdhcm5pbmdUaHJlc2hvbGQ6IG51bWJlcjsgLy8gTUJcbiAgcmVSZW5kZXJXYXJuaW5nVGhyZXNob2xkOiBudW1iZXI7XG4gIGNhY2hlSGl0UmF0ZU1pbmltdW06IG51bWJlcjsgLy8gcGVyY2VudGFnZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVzZVBlcmZvcm1hbmNlTW9uaXRvck9wdGlvbnMge1xuICBjb21wb25lbnROYW1lOiBzdHJpbmc7XG4gIGVuYWJsZWQ/OiBib29sZWFuO1xuICB0aHJlc2hvbGRzPzogUGFydGlhbDxQZXJmb3JtYW5jZVRocmVzaG9sZHM+O1xuICB0cmFja01lbW9yeT86IGJvb2xlYW47XG4gIHRyYWNrQ2FjaGVIaXRzPzogYm9vbGVhbjtcbiAgb25TbG93UmVuZGVyPzogKHJlbmRlclRpbWU6IG51bWJlcikgPT4gdm9pZDtcbiAgb25NZW1vcnlXYXJuaW5nPzogKHVzYWdlOiBudW1iZXIpID0+IHZvaWQ7XG4gIG9uT3B0aW1pemF0aW9uU3VnZ2VzdGlvbj86IChzdWdnZXN0aW9uczogc3RyaW5nW10pID0+IHZvaWQ7XG59XG5cbmNvbnN0IGRlZmF1bHRUaHJlc2hvbGRzOiBQZXJmb3JtYW5jZVRocmVzaG9sZHMgPSB7XG4gIHNsb3dSZW5kZXJUaHJlc2hvbGQ6IDE2LCAvLyA2MCBGUFMgPSAxNi42N21zIHBlciBmcmFtZVxuICBtZW1vcnlXYXJuaW5nVGhyZXNob2xkOiA1MCwgLy8gNTBNQlxuICByZVJlbmRlcldhcm5pbmdUaHJlc2hvbGQ6IDUsIC8vIDUgcmUtcmVuZGVycyBwZXIgc2Vjb25kXG4gIGNhY2hlSGl0UmF0ZU1pbmltdW06IDgwLCAvLyA4MCUgY2FjaGUgaGl0IHJhdGVcbn07XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VQZXJmb3JtYW5jZU1vbml0b3Iob3B0aW9uczogVXNlUGVyZm9ybWFuY2VNb25pdG9yT3B0aW9ucykge1xuICBjb25zdCB7XG4gICAgY29tcG9uZW50TmFtZSxcbiAgICBlbmFibGVkID0gdHJ1ZSxcbiAgICB0aHJlc2hvbGRzID0ge30sXG4gICAgdHJhY2tNZW1vcnkgPSB0cnVlLFxuICAgIHRyYWNrQ2FjaGVIaXRzID0gdHJ1ZSxcbiAgICBvblNsb3dSZW5kZXIsXG4gICAgb25NZW1vcnlXYXJuaW5nLFxuICAgIG9uT3B0aW1pemF0aW9uU3VnZ2VzdGlvbixcbiAgfSA9IG9wdGlvbnM7XG5cbiAgY29uc3QgZmluYWxUaHJlc2hvbGRzID0geyAuLi5kZWZhdWx0VGhyZXNob2xkcywgLi4udGhyZXNob2xkcyB9O1xuXG4gIGNvbnN0IFttZXRyaWNzLCBzZXRNZXRyaWNzXSA9IHVzZVN0YXRlPFBlcmZvcm1hbmNlTWV0cmljcz4oe1xuICAgIHJlbmRlclRpbWU6IDAsXG4gICAgY29tcG9uZW50TW91bnRzOiAwLFxuICAgIHJlUmVuZGVyczogMCxcbiAgICBtZW1vcnlVc2FnZTogMCxcbiAgICBsYXN0UmVuZGVyVGltZTogMCxcbiAgICBhdmVyYWdlUmVuZGVyVGltZTogMCxcbiAgICBzbG93UmVuZGVyczogMCxcbiAgICBjYWNoZUhpdFJhdGU6IDEwMCxcbiAgICBvcHRpbWl6YXRpb25TdWdnZXN0aW9uczogW10sXG4gIH0pO1xuXG4gIGNvbnN0IHJlbmRlclN0YXJ0VGltZSA9IHVzZVJlZjxudW1iZXI+KDApO1xuICBjb25zdCByZW5kZXJUaW1lcyA9IHVzZVJlZjxudW1iZXJbXT4oW10pO1xuICBjb25zdCBtb3VudFRpbWUgPSB1c2VSZWY8bnVtYmVyPigwKTtcbiAgY29uc3QgcmVSZW5kZXJDb3VudCA9IHVzZVJlZjxudW1iZXI+KDApO1xuICBjb25zdCBjYWNoZVJlcXVlc3RzID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIGNvbnN0IGNhY2hlSGl0cyA9IHVzZVJlZjxudW1iZXI+KDApO1xuICBjb25zdCBsYXN0UmVSZW5kZXJUaW1lID0gdXNlUmVmPG51bWJlcj4oMCk7XG4gIGNvbnN0IG1lbW9yeUNoZWNrSW50ZXJ2YWwgPSB1c2VSZWY8Tm9kZUpTLlRpbWVvdXQgfCBudWxsPihudWxsKTtcblxuICAvLyBUcmFjayBjb21wb25lbnQgbW91bnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoIWVuYWJsZWQpIHJldHVybjtcblxuICAgIG1vdW50VGltZS5jdXJyZW50ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgc2V0TWV0cmljcygocHJldikgPT4gKHtcbiAgICAgIC4uLnByZXYsXG4gICAgICBjb21wb25lbnRNb3VudHM6IHByZXYuY29tcG9uZW50TW91bnRzICsgMSxcbiAgICB9KSk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKG1lbW9yeUNoZWNrSW50ZXJ2YWwuY3VycmVudCkge1xuICAgICAgICBjbGVhckludGVydmFsKG1lbW9yeUNoZWNrSW50ZXJ2YWwuY3VycmVudCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW2VuYWJsZWRdKTtcblxuICAvLyBNZW1vcnkgbW9uaXRvcmluZ1xuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmICghZW5hYmxlZCB8fCAhdHJhY2tNZW1vcnkpIHJldHVybjtcblxuICAgIGNvbnN0IGNoZWNrTWVtb3J5ID0gKCkgPT4ge1xuICAgICAgaWYgKFwibWVtb3J5XCIgaW4gcGVyZm9ybWFuY2UpIHtcbiAgICAgICAgY29uc3QgbWVtSW5mbyA9IChwZXJmb3JtYW5jZSBhcyBhbnkpLm1lbW9yeTtcbiAgICAgICAgY29uc3QgdXNhZ2VJbk1CID0gbWVtSW5mby51c2VkSlNIZWFwU2l6ZSAvICgxMDI0ICogMTAyNCk7XG5cbiAgICAgICAgc2V0TWV0cmljcygocHJldikgPT4gKHtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIG1lbW9yeVVzYWdlOiB1c2FnZUluTUIsXG4gICAgICAgIH0pKTtcblxuICAgICAgICBpZiAodXNhZ2VJbk1CID4gZmluYWxUaHJlc2hvbGRzLm1lbW9yeVdhcm5pbmdUaHJlc2hvbGQpIHtcbiAgICAgICAgICBvbk1lbW9yeVdhcm5pbmc/Lih1c2FnZUluTUIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGNoZWNrTWVtb3J5KCk7XG4gICAgbWVtb3J5Q2hlY2tJbnRlcnZhbC5jdXJyZW50ID0gc2V0SW50ZXJ2YWwoY2hlY2tNZW1vcnksIDUwMDApOyAvLyBDaGVjayBldmVyeSA1IHNlY29uZHNcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpZiAobWVtb3J5Q2hlY2tJbnRlcnZhbC5jdXJyZW50KSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwobWVtb3J5Q2hlY2tJbnRlcnZhbC5jdXJyZW50KTtcbiAgICAgIH1cbiAgICB9O1xuICB9LCBbXG4gICAgZW5hYmxlZCxcbiAgICB0cmFja01lbW9yeSxcbiAgICBmaW5hbFRocmVzaG9sZHMubWVtb3J5V2FybmluZ1RocmVzaG9sZCxcbiAgICBvbk1lbW9yeVdhcm5pbmcsXG4gIF0pO1xuXG4gIC8vIFJlbmRlciBwZXJmb3JtYW5jZSB0cmFja2luZ1xuICBjb25zdCBzdGFydFJlbmRlciA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIWVuYWJsZWQpIHJldHVybjtcbiAgICByZW5kZXJTdGFydFRpbWUuY3VycmVudCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICB9LCBbZW5hYmxlZF0pO1xuXG4gIGNvbnN0IGVuZFJlbmRlciA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIWVuYWJsZWQgfHwgcmVuZGVyU3RhcnRUaW1lLmN1cnJlbnQgPT09IDApIHJldHVybjtcblxuICAgIGNvbnN0IHJlbmRlclRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHJlbmRlclN0YXJ0VGltZS5jdXJyZW50O1xuICAgIHJlbmRlclRpbWVzLmN1cnJlbnQucHVzaChyZW5kZXJUaW1lKTtcblxuICAgIC8vIEtlZXAgb25seSBsYXN0IDEwMCByZW5kZXIgdGltZXMgZm9yIGF2ZXJhZ2UgY2FsY3VsYXRpb25cbiAgICBpZiAocmVuZGVyVGltZXMuY3VycmVudC5sZW5ndGggPiAxMDApIHtcbiAgICAgIHJlbmRlclRpbWVzLmN1cnJlbnQuc2hpZnQoKTtcbiAgICB9XG5cbiAgICBjb25zdCBhdmVyYWdlUmVuZGVyVGltZSA9XG4gICAgICByZW5kZXJUaW1lcy5jdXJyZW50LnJlZHVjZSgoc3VtLCB0aW1lKSA9PiBzdW0gKyB0aW1lLCAwKSAvXG4gICAgICByZW5kZXJUaW1lcy5jdXJyZW50Lmxlbmd0aDtcbiAgICBjb25zdCBpc1Nsb3dSZW5kZXIgPSByZW5kZXJUaW1lID4gZmluYWxUaHJlc2hvbGRzLnNsb3dSZW5kZXJUaHJlc2hvbGQ7XG5cbiAgICAvLyBUcmFjayByZS1yZW5kZXJzXG4gICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICBpZiAobm93IC0gbGFzdFJlUmVuZGVyVGltZS5jdXJyZW50IDwgMTAwMCkge1xuICAgICAgcmVSZW5kZXJDb3VudC5jdXJyZW50Kys7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlUmVuZGVyQ291bnQuY3VycmVudCA9IDE7XG4gICAgfVxuICAgIGxhc3RSZVJlbmRlclRpbWUuY3VycmVudCA9IG5vdztcblxuICAgIHNldE1ldHJpY3MoKHByZXYpID0+ICh7XG4gICAgICAuLi5wcmV2LFxuICAgICAgcmVuZGVyVGltZSxcbiAgICAgIGxhc3RSZW5kZXJUaW1lOiByZW5kZXJUaW1lLFxuICAgICAgYXZlcmFnZVJlbmRlclRpbWUsXG4gICAgICByZVJlbmRlcnM6IHByZXYucmVSZW5kZXJzICsgMSxcbiAgICAgIHNsb3dSZW5kZXJzOiBwcmV2LnNsb3dSZW5kZXJzICsgKGlzU2xvd1JlbmRlciA/IDEgOiAwKSxcbiAgICB9KSk7XG5cbiAgICBpZiAoaXNTbG93UmVuZGVyKSB7XG4gICAgICBvblNsb3dSZW5kZXI/LihyZW5kZXJUaW1lKTtcbiAgICB9XG5cbiAgICByZW5kZXJTdGFydFRpbWUuY3VycmVudCA9IDA7XG4gIH0sIFtlbmFibGVkLCBmaW5hbFRocmVzaG9sZHMuc2xvd1JlbmRlclRocmVzaG9sZCwgb25TbG93UmVuZGVyXSk7XG5cbiAgLy8gQ2FjaGUgcGVyZm9ybWFuY2UgdHJhY2tpbmdcbiAgY29uc3QgdHJhY2tDYWNoZVJlcXVlc3QgPSB1c2VDYWxsYmFjayhcbiAgICAoaXNIaXQ6IGJvb2xlYW4gPSBmYWxzZSkgPT4ge1xuICAgICAgaWYgKCFlbmFibGVkIHx8ICF0cmFja0NhY2hlSGl0cykgcmV0dXJuO1xuXG4gICAgICBjYWNoZVJlcXVlc3RzLmN1cnJlbnQrKztcbiAgICAgIGlmIChpc0hpdCkge1xuICAgICAgICBjYWNoZUhpdHMuY3VycmVudCsrO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBoaXRSYXRlID0gKGNhY2hlSGl0cy5jdXJyZW50IC8gY2FjaGVSZXF1ZXN0cy5jdXJyZW50KSAqIDEwMDtcblxuICAgICAgc2V0TWV0cmljcygocHJldikgPT4gKHtcbiAgICAgICAgLi4ucHJldixcbiAgICAgICAgY2FjaGVIaXRSYXRlOiBoaXRSYXRlLFxuICAgICAgfSkpO1xuICAgIH0sXG4gICAgW2VuYWJsZWQsIHRyYWNrQ2FjaGVIaXRzXSxcbiAgKTtcblxuICAvLyBHZW5lcmF0ZSBvcHRpbWl6YXRpb24gc3VnZ2VzdGlvbnNcbiAgY29uc3QgZ2VuZXJhdGVPcHRpbWl6YXRpb25TdWdnZXN0aW9ucyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBzdWdnZXN0aW9uczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChtZXRyaWNzLmF2ZXJhZ2VSZW5kZXJUaW1lID4gZmluYWxUaHJlc2hvbGRzLnNsb3dSZW5kZXJUaHJlc2hvbGQpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goXG4gICAgICAgIGBDb25zaWRlciBtZW1vaXppbmcgJHtjb21wb25lbnROYW1lfSAtIGF2ZXJhZ2UgcmVuZGVyIHRpbWUgaXMgJHttZXRyaWNzLmF2ZXJhZ2VSZW5kZXJUaW1lLnRvRml4ZWQoMil9bXNgLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAocmVSZW5kZXJDb3VudC5jdXJyZW50ID4gZmluYWxUaHJlc2hvbGRzLnJlUmVuZGVyV2FybmluZ1RocmVzaG9sZCkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgYEhpZ2ggcmUtcmVuZGVyIGZyZXF1ZW5jeSBkZXRlY3RlZCBpbiAke2NvbXBvbmVudE5hbWV9IC0gY29uc2lkZXIgb3B0aW1pemluZyBkZXBlbmRlbmNpZXNgLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAobWV0cmljcy5tZW1vcnlVc2FnZSA+IGZpbmFsVGhyZXNob2xkcy5tZW1vcnlXYXJuaW5nVGhyZXNob2xkKSB7XG4gICAgICBzdWdnZXN0aW9ucy5wdXNoKFxuICAgICAgICBgSGlnaCBtZW1vcnkgdXNhZ2UgZGV0ZWN0ZWQgKCR7bWV0cmljcy5tZW1vcnlVc2FnZS50b0ZpeGVkKDIpfU1CKSAtIGNoZWNrIGZvciBtZW1vcnkgbGVha3NgLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAobWV0cmljcy5jYWNoZUhpdFJhdGUgPCBmaW5hbFRocmVzaG9sZHMuY2FjaGVIaXRSYXRlTWluaW11bSkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgYExvdyBjYWNoZSBoaXQgcmF0ZSAoJHttZXRyaWNzLmNhY2hlSGl0UmF0ZS50b0ZpeGVkKDEpfSUpIC0gb3B0aW1pemUgY2FjaGluZyBzdHJhdGVneWAsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLnNsb3dSZW5kZXJzID4gNSkge1xuICAgICAgc3VnZ2VzdGlvbnMucHVzaChcbiAgICAgICAgYCR7bWV0cmljcy5zbG93UmVuZGVyc30gc2xvdyByZW5kZXJzIGRldGVjdGVkIC0gY29uc2lkZXIgY29kZSBzcGxpdHRpbmcgb3IgdmlydHVhbGl6YXRpb25gLFxuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gIH0sIFttZXRyaWNzLCBmaW5hbFRocmVzaG9sZHMsIGNvbXBvbmVudE5hbWUsIHJlUmVuZGVyQ291bnRdKTtcblxuICAvLyBVcGRhdGUgc3VnZ2VzdGlvbnMgcGVyaW9kaWNhbGx5XG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKCFlbmFibGVkKSByZXR1cm47XG5cbiAgICBjb25zdCBzdWdnZXN0aW9ucyA9IGdlbmVyYXRlT3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMoKTtcbiAgICBpZiAoXG4gICAgICBzdWdnZXN0aW9ucy5sZW5ndGggIT09IG1ldHJpY3Mub3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMubGVuZ3RoIHx8XG4gICAgICBzdWdnZXN0aW9ucy5zb21lKChzLCBpKSA9PiBzICE9PSBtZXRyaWNzLm9wdGltaXphdGlvblN1Z2dlc3Rpb25zW2ldKVxuICAgICkge1xuICAgICAgc2V0TWV0cmljcygocHJldikgPT4gKHtcbiAgICAgICAgLi4ucHJldixcbiAgICAgICAgb3B0aW1pemF0aW9uU3VnZ2VzdGlvbnM6IHN1Z2dlc3Rpb25zLFxuICAgICAgfSkpO1xuXG4gICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBvbk9wdGltaXphdGlvblN1Z2dlc3Rpb24/LihzdWdnZXN0aW9ucyk7XG4gICAgICB9XG4gICAgfVxuICB9LCBbXG4gICAgZW5hYmxlZCxcbiAgICBnZW5lcmF0ZU9wdGltaXphdGlvblN1Z2dlc3Rpb25zLFxuICAgIG1ldHJpY3Mub3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMsXG4gICAgb25PcHRpbWl6YXRpb25TdWdnZXN0aW9uLFxuICBdKTtcblxuICAvLyBQZXJmb3JtYW5jZSBwcm9maWxlciBob29rc1xuICBjb25zdCBwcm9maWxlUmVuZGVyID0gdXNlQ2FsbGJhY2soXG4gICAgKHJlbmRlckZuOiAoKSA9PiB2b2lkKSA9PiB7XG4gICAgICBzdGFydFJlbmRlcigpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVuZGVyRm4oKTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGVuZFJlbmRlcigpO1xuICAgICAgfVxuICAgIH0sXG4gICAgW3N0YXJ0UmVuZGVyLCBlbmRSZW5kZXJdLFxuICApO1xuXG4gIC8vIEdldCBwZXJmb3JtYW5jZSByZXBvcnRcbiAgY29uc3QgZ2V0UGVyZm9ybWFuY2VSZXBvcnQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgY29uc3QgcmVwb3J0ID0ge1xuICAgICAgY29tcG9uZW50TmFtZSxcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgbWV0cmljczogeyAuLi5tZXRyaWNzIH0sXG4gICAgICB0aHJlc2hvbGRzOiBmaW5hbFRocmVzaG9sZHMsXG4gICAgICByZW5kZXJUaW1lc0hpc3Rvcnk6IFsuLi5yZW5kZXJUaW1lcy5jdXJyZW50XSxcbiAgICAgIHN1Z2dlc3Rpb25zOiBnZW5lcmF0ZU9wdGltaXphdGlvblN1Z2dlc3Rpb25zKCksXG4gICAgICBoZWFsdGhTY29yZTogY2FsY3VsYXRlSGVhbHRoU2NvcmUoKSxcbiAgICB9O1xuXG4gICAgcmV0dXJuIHJlcG9ydDtcbiAgfSwgW1xuICAgIGNvbXBvbmVudE5hbWUsXG4gICAgbWV0cmljcyxcbiAgICBmaW5hbFRocmVzaG9sZHMsXG4gICAgZ2VuZXJhdGVPcHRpbWl6YXRpb25TdWdnZXN0aW9ucyxcbiAgXSk7XG5cbiAgLy8gQ2FsY3VsYXRlIG92ZXJhbGwgaGVhbHRoIHNjb3JlICgwLTEwMClcbiAgY29uc3QgY2FsY3VsYXRlSGVhbHRoU2NvcmUgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgbGV0IHNjb3JlID0gMTAwO1xuXG4gICAgLy8gRGVkdWN0IHBvaW50cyBmb3IgcGVyZm9ybWFuY2UgaXNzdWVzXG4gICAgaWYgKG1ldHJpY3MuYXZlcmFnZVJlbmRlclRpbWUgPiBmaW5hbFRocmVzaG9sZHMuc2xvd1JlbmRlclRocmVzaG9sZCkge1xuICAgICAgc2NvcmUgLT0gTWF0aC5taW4oXG4gICAgICAgIDMwLFxuICAgICAgICAobWV0cmljcy5hdmVyYWdlUmVuZGVyVGltZSAtIGZpbmFsVGhyZXNob2xkcy5zbG93UmVuZGVyVGhyZXNob2xkKSAqIDIsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLm1lbW9yeVVzYWdlID4gZmluYWxUaHJlc2hvbGRzLm1lbW9yeVdhcm5pbmdUaHJlc2hvbGQpIHtcbiAgICAgIHNjb3JlIC09IE1hdGgubWluKFxuICAgICAgICAyNSxcbiAgICAgICAgKG1ldHJpY3MubWVtb3J5VXNhZ2UgLSBmaW5hbFRocmVzaG9sZHMubWVtb3J5V2FybmluZ1RocmVzaG9sZCkgKiAwLjUsXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChtZXRyaWNzLmNhY2hlSGl0UmF0ZSA8IGZpbmFsVGhyZXNob2xkcy5jYWNoZUhpdFJhdGVNaW5pbXVtKSB7XG4gICAgICBzY29yZSAtPSBNYXRoLm1pbihcbiAgICAgICAgMjAsXG4gICAgICAgIChmaW5hbFRocmVzaG9sZHMuY2FjaGVIaXRSYXRlTWluaW11bSAtIG1ldHJpY3MuY2FjaGVIaXRSYXRlKSAqIDAuNSxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHJlUmVuZGVyQ291bnQuY3VycmVudCA+IGZpbmFsVGhyZXNob2xkcy5yZVJlbmRlcldhcm5pbmdUaHJlc2hvbGQpIHtcbiAgICAgIHNjb3JlIC09IE1hdGgubWluKFxuICAgICAgICAxNSxcbiAgICAgICAgKHJlUmVuZGVyQ291bnQuY3VycmVudCAtIGZpbmFsVGhyZXNob2xkcy5yZVJlbmRlcldhcm5pbmdUaHJlc2hvbGQpICogMyxcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKG1ldHJpY3Muc2xvd1JlbmRlcnMgPiAwKSB7XG4gICAgICBzY29yZSAtPSBNYXRoLm1pbigxMCwgbWV0cmljcy5zbG93UmVuZGVycyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE1hdGgubWF4KDAsIE1hdGgucm91bmQoc2NvcmUpKTtcbiAgfSwgW21ldHJpY3MsIGZpbmFsVGhyZXNob2xkcywgcmVSZW5kZXJDb3VudF0pO1xuXG4gIC8vIFJlc2V0IG1ldHJpY3NcbiAgY29uc3QgcmVzZXRNZXRyaWNzID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHJlbmRlclRpbWVzLmN1cnJlbnQgPSBbXTtcbiAgICByZVJlbmRlckNvdW50LmN1cnJlbnQgPSAwO1xuICAgIGNhY2hlUmVxdWVzdHMuY3VycmVudCA9IDA7XG4gICAgY2FjaGVIaXRzLmN1cnJlbnQgPSAwO1xuXG4gICAgc2V0TWV0cmljcyh7XG4gICAgICByZW5kZXJUaW1lOiAwLFxuICAgICAgY29tcG9uZW50TW91bnRzOiAwLFxuICAgICAgcmVSZW5kZXJzOiAwLFxuICAgICAgbWVtb3J5VXNhZ2U6IDAsXG4gICAgICBsYXN0UmVuZGVyVGltZTogMCxcbiAgICAgIGF2ZXJhZ2VSZW5kZXJUaW1lOiAwLFxuICAgICAgc2xvd1JlbmRlcnM6IDAsXG4gICAgICBjYWNoZUhpdFJhdGU6IDEwMCxcbiAgICAgIG9wdGltaXphdGlvblN1Z2dlc3Rpb25zOiBbXSxcbiAgICB9KTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiB7XG4gICAgbWV0cmljcyxcbiAgICBzdGFydFJlbmRlcixcbiAgICBlbmRSZW5kZXIsXG4gICAgdHJhY2tDYWNoZVJlcXVlc3QsXG4gICAgcHJvZmlsZVJlbmRlcixcbiAgICBnZXRQZXJmb3JtYW5jZVJlcG9ydCxcbiAgICByZXNldE1ldHJpY3MsXG4gICAgaGVhbHRoU2NvcmU6IGNhbGN1bGF0ZUhlYWx0aFNjb3JlKCksXG4gICAgaXNFbmFibGVkOiBlbmFibGVkLFxuICB9O1xufVxuIl0sIm5hbWVzIjpbInVzZVBlcmZvcm1hbmNlTW9uaXRvciIsImRlZmF1bHRUaHJlc2hvbGRzIiwic2xvd1JlbmRlclRocmVzaG9sZCIsIm1lbW9yeVdhcm5pbmdUaHJlc2hvbGQiLCJyZVJlbmRlcldhcm5pbmdUaHJlc2hvbGQiLCJjYWNoZUhpdFJhdGVNaW5pbXVtIiwib3B0aW9ucyIsImNvbXBvbmVudE5hbWUiLCJlbmFibGVkIiwidGhyZXNob2xkcyIsInRyYWNrTWVtb3J5IiwidHJhY2tDYWNoZUhpdHMiLCJvblNsb3dSZW5kZXIiLCJvbk1lbW9yeVdhcm5pbmciLCJvbk9wdGltaXphdGlvblN1Z2dlc3Rpb24iLCJmaW5hbFRocmVzaG9sZHMiLCJtZXRyaWNzIiwic2V0TWV0cmljcyIsInVzZVN0YXRlIiwicmVuZGVyVGltZSIsImNvbXBvbmVudE1vdW50cyIsInJlUmVuZGVycyIsIm1lbW9yeVVzYWdlIiwibGFzdFJlbmRlclRpbWUiLCJhdmVyYWdlUmVuZGVyVGltZSIsInNsb3dSZW5kZXJzIiwiY2FjaGVIaXRSYXRlIiwib3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMiLCJyZW5kZXJTdGFydFRpbWUiLCJ1c2VSZWYiLCJyZW5kZXJUaW1lcyIsIm1vdW50VGltZSIsInJlUmVuZGVyQ291bnQiLCJjYWNoZVJlcXVlc3RzIiwiY2FjaGVIaXRzIiwibGFzdFJlUmVuZGVyVGltZSIsIm1lbW9yeUNoZWNrSW50ZXJ2YWwiLCJ1c2VFZmZlY3QiLCJjdXJyZW50IiwicGVyZm9ybWFuY2UiLCJub3ciLCJwcmV2IiwiY2xlYXJJbnRlcnZhbCIsImNoZWNrTWVtb3J5IiwibWVtSW5mbyIsIm1lbW9yeSIsInVzYWdlSW5NQiIsInVzZWRKU0hlYXBTaXplIiwic2V0SW50ZXJ2YWwiLCJzdGFydFJlbmRlciIsInVzZUNhbGxiYWNrIiwiZW5kUmVuZGVyIiwicHVzaCIsImxlbmd0aCIsInNoaWZ0IiwicmVkdWNlIiwic3VtIiwidGltZSIsImlzU2xvd1JlbmRlciIsIkRhdGUiLCJ0cmFja0NhY2hlUmVxdWVzdCIsImlzSGl0IiwiaGl0UmF0ZSIsImdlbmVyYXRlT3B0aW1pemF0aW9uU3VnZ2VzdGlvbnMiLCJzdWdnZXN0aW9ucyIsInRvRml4ZWQiLCJzb21lIiwicyIsImkiLCJwcm9maWxlUmVuZGVyIiwicmVuZGVyRm4iLCJnZXRQZXJmb3JtYW5jZVJlcG9ydCIsInJlcG9ydCIsInRpbWVzdGFtcCIsInRvSVNPU3RyaW5nIiwicmVuZGVyVGltZXNIaXN0b3J5IiwiaGVhbHRoU2NvcmUiLCJjYWxjdWxhdGVIZWFsdGhTY29yZSIsInNjb3JlIiwiTWF0aCIsIm1pbiIsIm1heCIsInJvdW5kIiwicmVzZXRNZXRyaWNzIiwiaXNFbmFibGVkIl0sIm1hcHBpbmdzIjoiQUFBQTs7Ozs7K0JBeUNnQkE7OztlQUFBQTs7O3VCQXZDeUM7QUFnQ3pELE1BQU1DLG9CQUEyQztJQUMvQ0MscUJBQXFCO0lBQ3JCQyx3QkFBd0I7SUFDeEJDLDBCQUEwQjtJQUMxQkMscUJBQXFCO0FBQ3ZCO0FBRU8sU0FBU0wsc0JBQXNCTSxPQUFxQztJQUN6RSxNQUFNLEVBQ0pDLGFBQWEsRUFDYkMsVUFBVSxJQUFJLEVBQ2RDLGFBQWEsQ0FBQyxDQUFDLEVBQ2ZDLGNBQWMsSUFBSSxFQUNsQkMsaUJBQWlCLElBQUksRUFDckJDLFlBQVksRUFDWkMsZUFBZSxFQUNmQyx3QkFBd0IsRUFDekIsR0FBR1I7SUFFSixNQUFNUyxrQkFBa0I7UUFBRSxHQUFHZCxpQkFBaUI7UUFBRSxHQUFHUSxVQUFVO0lB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