{
  "timestamp": "2025-07-16T09:42:25.025956",
  "environment": "production",
  "security_audit": {
    "permissions": {
      "file_permissions": {
        "severity": "CRITICAL",
        "issues": [
          {
            "file": "secrets/postgres_password.txt",
            "expected": "0o600",
            "actual": "0o644"
          },
          {
            "file": "secrets/redis_password.txt",
            "expected": "0o600",
            "actual": "0o644"
          },
          {
            "file": "secrets/secret_key.txt",
            "expected": "0o600",
            "actual": "0o644"
          }
        ],
        "message": "File permission issues: 3"
      }
    },
    "secrets": {
      "secret_strength": {
        "severity": "HIGH",
        "weak_secrets": [
          "Default admin credentials",
          "Local configuration in production"
        ],
        "message": "Weak secrets found: 2"
      }
    },
    "docker": {
      "container_security": {
        "severity": "PASS",
        "security_issues": [],
        "message": "Docker security issues: 0"
      }
    },
    "ssl": {
      "ssl_configuration": {
        "severity": "HIGH",
        "ssl_issues": [
          "weak_protocols"
        ],
        "message": "SSL security issues: 1"
      }
    },
    "api": {
      "api_security": {
        "severity": "HIGH",
        "api_issues": [
          "rate_limiting",
          "csrf_protection",
          "input_validation"
        ],
        "message": "API security issues: 3"
      }
    },
    "database": {
      "database_security": {
        "severity": "MEDIUM",
        "db_issues": [
          "No role-based access control setup"
        ],
        "message": "Database security issues: 1"
      }
    },
    "authentication": {
      "auth_security": {
        "severity": "HIGH",
        "auth_issues": [
          "auth/jwt_handler.py: password_hashing",
          "auth/jwt_handler.py: rate_limiting",
          "auth/jwt_handler.py: session_management",
          "auth/rbac_security_enhancements.py: password_hashing",
          "auth/rbac_security_enhancements.py: jwt_validation"
        ],
        "message": "Authentication security issues: 5"
      }
    },
    "monitoring": {
      "monitoring_security": {
        "severity": "MEDIUM",
        "monitoring_issues": [
          "intrusion_detection",
          "Security log file has overly permissive permissions"
        ],
        "message": "Monitoring security issues: 2"
      }
    },
    "testing": {
      "security_test_coverage": {
        "severity": "PASS",
        "total_tests": 32,
        "test_coverage": [
          "authentication: 2 tests",
          "authorization: 3 tests",
          "input_validation: 3 tests",
          "crypto: 2 tests",
          "penetration: 1 tests"
        ],
        "message": "Security tests: 32 found"
      }
    },
    "penetration": {
      "vulnerability_scan": {
        "severity": "CRITICAL",
        "vulnerabilities": [
          "Weak encryption algorithm des found in auth/resource_access_control.py",
          "Weak encryption algorithm des found in auth/https_enforcement.py",
          "Weak encryption algorithm des found in auth/security_implementation.py",
          "Weak encryption algorithm des found in auth/security_headers.py",
          "Weak encryption algorithm des found in auth/rbac_enhancements.py",
          "Weak encryption algorithm des found in auth/security_logging.py",
          "Weak encryption algorithm des found in auth/comprehensive_audit_logger.py",
          "Weak encryption algorithm des found in auth/certificate_pinning.py",
          "Weak encryption algorithm des found in auth/ssl_tls_config.py",
          "Weak encryption algorithm des found in auth/mfa_service.py",
          "Weak encryption algorithm des found in api/main.py",
          "Weak encryption algorithm des found in api/middleware/websocket_rate_limiting.py",
          "Weak encryption algorithm des found in api/middleware/rate_limiter.py",
          "Weak encryption algorithm des found in api/v1/mfa.py",
          "Weak encryption algorithm des found in api/v1/inference.py",
          "Weak encryption algorithm des found in api/v1/graphql_schema.py",
          "Weak encryption algorithm des found in api/v1/admin.py",
          "Weak encryption algorithm des found in api/v1/health.py",
          "Weak encryption algorithm des found in api/v1/websocket.py",
          "Weak encryption algorithm des found in api/v1/agents.py",
          "Weak encryption algorithm des found in api/v1/security.py",
          "Weak encryption algorithm des found in api/v1/knowledge.py",
          "Weak encryption algorithm des found in api/v1/models/response_models.py",
          "A01_Broken_Access_Control: No authorization middleware found",
          "A02_Cryptographic_Failures: No secure random generation detected",
          "A06_Vulnerable_Components: Dependency vulnerability scan needed",
          "A08_Software_Integrity_Failures: No deployment verification script found"
        ],
        "message": "Vulnerabilities found: 27"
      }
    }
  },
  "vulnerabilities": [
    "Weak encryption algorithm des found in auth/resource_access_control.py",
    "Weak encryption algorithm des found in auth/https_enforcement.py",
    "Weak encryption algorithm des found in auth/security_implementation.py",
    "Weak encryption algorithm des found in auth/security_headers.py",
    "Weak encryption algorithm des found in auth/rbac_enhancements.py",
    "Weak encryption algorithm des found in auth/security_logging.py",
    "Weak encryption algorithm des found in auth/comprehensive_audit_logger.py",
    "Weak encryption algorithm des found in auth/certificate_pinning.py",
    "Weak encryption algorithm des found in auth/ssl_tls_config.py",
    "Weak encryption algorithm des found in auth/mfa_service.py",
    "Weak encryption algorithm des found in api/main.py",
    "Weak encryption algorithm des found in api/middleware/websocket_rate_limiting.py",
    "Weak encryption algorithm des found in api/middleware/rate_limiter.py",
    "Weak encryption algorithm des found in api/v1/mfa.py",
    "Weak encryption algorithm des found in api/v1/inference.py",
    "Weak encryption algorithm des found in api/v1/graphql_schema.py",
    "Weak encryption algorithm des found in api/v1/admin.py",
    "Weak encryption algorithm des found in api/v1/health.py",
    "Weak encryption algorithm des found in api/v1/websocket.py",
    "Weak encryption algorithm des found in api/v1/agents.py",
    "Weak encryption algorithm des found in api/v1/security.py",
    "Weak encryption algorithm des found in api/v1/knowledge.py",
    "Weak encryption algorithm des found in api/v1/models/response_models.py",
    "A01_Broken_Access_Control: No authorization middleware found",
    "A02_Cryptographic_Failures: No secure random generation detected",
    "A06_Vulnerable_Components: Dependency vulnerability scan needed",
    "A08_Software_Integrity_Failures: No deployment verification script found"
  ],
  "security_score": 50,
  "recommendations": [
    "\ud83d\udea8 CRITICAL: Address all critical security issues immediately",
    "  - Fix: permissions: file_permissions",
    "  - Fix: penetration: vulnerability_scan",
    "\u26a0\ufe0f HIGH/MEDIUM: Review and address security warnings",
    "  - Review: secrets: secret_strength",
    "  - Review: ssl: ssl_configuration",
    "  - Review: api: api_security",
    "  - Review: database: database_security",
    "  - Review: authentication: auth_security",
    "\ud83d\udd10 Implement regular security audits",
    "\ud83d\udee1\ufe0f Set up automated vulnerability scanning",
    "\ud83d\udcca Enable comprehensive security monitoring",
    "\ud83d\udd04 Establish incident response procedures",
    "\ud83d\udcda Conduct security training for development team"
  ],
  "compliance_status": {
    "critical_issues": 2,
    "security_warnings": 6,
    "security_passes": 2,
    "production_ready": false
  }
}